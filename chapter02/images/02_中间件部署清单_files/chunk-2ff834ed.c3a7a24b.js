(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ff834ed"],{"06c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("fb6a"),r("d3b7"),r("b0c0"),r("a630"),r("3ca3");var n=r("6b75");function o(e,t){if(e){if("string"===typeof e)return Object(n["a"])(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n["a"])(e,t):void 0}}},1276:function(e,t,r){"use strict";var n=r("d784"),o=r("44e7"),a=r("825a"),i=r("1d80"),s=r("4840"),l=r("8aa5"),c=r("50c4"),u=r("14c3"),d=r("9263"),f=r("9f7f"),m=r("d039"),h=f.UNSUPPORTED_Y,p=[].push,g=Math.min,v=4294967295,w=!m((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));n("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(i(this)),a=void 0===r?v:r>>>0;if(0===a)return[];if(void 0===e)return[n];if(!o(e))return t.call(n,e,a);var s,l,c,u=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,h=new RegExp(e.source,f+"g");while(s=d.call(h,n)){if(l=h.lastIndex,l>m&&(u.push(n.slice(m,s.index)),s.length>1&&s.index<n.length&&p.apply(u,s.slice(1)),c=s[0].length,m=l,u.length>=a))break;h.lastIndex===s.index&&h.lastIndex++}return m===n.length?!c&&h.test("")||u.push(""):u.push(n.slice(m)),u.length>a?u.slice(0,a):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var o=i(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,o,r):n.call(String(o),t,r)},function(e,o){var i=r(n,this,e,o,n!==t);if(i.done)return i.value;var d=a(this),f=String(e),m=s(d,RegExp),p=d.unicode,w=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(h?"g":"y"),C=new m(h?"^(?:"+d.source+")":d,w),b=void 0===o?v:o>>>0;if(0===b)return[];if(0===f.length)return null===u(C,f)?[f]:[];var S=0,y=0,x=[];while(y<f.length){C.lastIndex=h?0:y;var N,T=u(C,h?f.slice(y):f);if(null===T||(N=g(c(C.lastIndex+(h?y:0)),f.length))===S)y=l(f,y,p);else{if(x.push(f.slice(S,y)),x.length===b)return x;for(var O=1;O<=T.length-1;O++)if(x.push(T[O]),x.length===b)return x;y=S=N}}return x.push(f.slice(S)),x}]}),!w,h)},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("6b75");function o(e){if(Array.isArray(e))return Object(n["a"])(e)}var a=r("db90"),i=r("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return o(e)||Object(a["a"])(e)||Object(i["a"])(e)||s()}},"2f0b":function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return u}));r("159b"),r("b0c0"),r("a434"),r("bf19"),r("caad"),r("2532"),r("b680");var n=r("2c3c"),o=r("f121"),a=r("a8ef"),i=function(e){var t=e.contextMenu.menuData;t.forEach((function(e){e&&("gc.spread.insertRows"===e.name&&(e.text="向下插入行",e.command="gc.SN.contextMenu.insertMoreRows"),"gc.spread.insertColumns"===e.name&&(e.text="向左插入列",e.command="gc.SN.contextMenu.insertColumns"),"gc.spread.hideSheet"===e.name&&(e.command="gc.SN.spread.contextMenu.hideSheet"),"gc.spread.unhideSheet"===e.name&&(e.text="取消隐藏",e.command="gc.SN.spread.contextMenu.unhideSheet"),"gc.spread.unhideColumns"!==e.name&&"gc.spread.unhideRows"!==e.name||(e.text="取消隐藏"))}))},s=function(e){function t(){}t.prototype=new GC.Spread.Sheets.ContextMenu.ContextMenu(e),t.prototype.onOpenMenu=function(t,r,n,a){var i=r;if(null!==n&&void 0!==n&&n.worksheetHitInfo){var s=n.worksheetHitInfo,l=s.hitTestType,c=s.floatingObjectHitInfo;if(c&&c.floatingObject)r.push({text:"下载图片",name:"gc.spread.downloadPicture",command:"downloadPicture",workArea:"viewport"}),o["f"].isSensitive||r.push({text:"转为单元格内图片",name:"gc.spread.transformToCellImage",command:"transformToCellImage",workArea:"viewport"},{text:"全部转为单元格内图片",name:"gc.spread.transformAllToCellImage",command:"transformAllToCellImage",workArea:"viewport"});else if(3==l){var u=e.getActiveSheet(),d=u.getActiveColumnIndex(),f=u.getActiveRowIndex(),m=u.getHyperlink(f,d);m||i.splice(16,3);var h=u.getCell(f,d);h.backgroundImage()&&i.push({text:"下载图片",name:"gc.spread.downloadCellPicture",command:"downloadCellPicture",workArea:"viewport"},{text:"转为浮动图片",name:"gc.spread.transformToImage",command:"transformToImage",workArea:"viewport"},{text:"全部转为浮动图片",name:"gc.spread.transformAllToImage",command:"transformAllToImage",workArea:"viewport"}),u.getCellType(f,d)instanceof GC.Spread.Sheets.CellTypes.CheckBox&&i.push({text:"清除复选框",name:"gc.spread.clearCheckbox",command:"clearCheckbox",workArea:"viewport"})}}};var r=new t;e.contextMenu=r,i(e)},l=function(){var e=this.spread.commandManager(),t=this;this.spread.contextMenu.menuData.push(a["b"].columnWidth,a["b"].rowHeight,a["b"].sheetCopy,a["b"].editHyperlink,a["b"].delHyperlink),this.spread.contextMenu.menuData.splice(12,0,a["b"].insertRowsTopMenu),this.spread.contextMenu.menuData.splice(15,0,a["b"].insertAfterColumns);var r={canUndo:!1,execute:function(e,r){var n=r.activeCol,o=r.sheetName,a=e.getSheetFromName(o);t.customSpreadMenuV=a.getColumnWidth(n),t.customSpreadMenuFlag=!0,t.customSpreadMenu="列宽",t.$refs.colWidthTip.style.display="none"}},o={canUndo:!1,execute:function(e,r){var n=r.activeRow,o=r.sheetName,a=e.getSheetFromName(o);t.customSpreadMenuV=a.getRowHeight(n),t.customSpreadMenuFlag=!0,t.customSpreadMenu="行高",t.$refs.colWidthTip.style.display="none"}},i={canUndo:!0,name:"gc.SN.contextMenu.insertMoreRows",execute:function(e,r,n){var o=GC.Spread.Sheets.Commands;return n?(o.undoTransaction(e,r),!0):(o.startTransaction(e,r),t.insetMoreRowDialogVisible=!0,t.insertTopRows=!1,t.insertRowCol="插入行数",o.endTransaction(e,r),!0)}},s={canUndo:!0,name:"gc.SN.spread.contextMenu.hideSheet",execute:function(e,r,o){var a=GC.Spread.Sheets.Commands,i=r.sheetName,s=e.getSheetCount(),l=e.getSheetFromName(i);if(o)return a.undoTransaction(e,r),l.visible(!0),!0;for(var c=0,u=0;u<s;u++)!e.sheets[u].visible()&&c++;if(c==s-1)n["a"].warning("操作无效,至少展示一个sheet!");else{var d={opType:"setSheetHidden",sheetName:i,hidden:!0};a.startTransaction(e,r),l.visible(!1),a.endTransaction(e,r),t.editDataList.push({content:JSON.stringify([d]),opType:"setSheetHidden",sheetName:i})}return!0}},l={canUndo:!0,name:"gc.SN.spread.contextMenu.unhideSheet",execute:function(e,r,n){for(var o=e.getSheetCount(),a=[],i=0;i<o;i++)e.sheets[i].visible()||a.push(e.sheets[i].name());return t.hiddenSheetList=a,t.showSheetDialogVisible=!0,!0}},c={canUndo:!1,execute:function(e,r){var n=r.sheetName,o=e.getSheetFromName(n),a="".concat(n,"副本(1)"),i=e.getActiveSheetIndex(),s=new GC.Spread.Sheets.Worksheet,l=JSON.stringify(e.toJSON());t.worker.postMessage("copySheetName",[l,a]).then((function(r){var a=o.toJSON();a.name=r,s.fromJSON(a),e.addSheet(i+1,s);var l={opType:"cloneSheet",sheetName:n,newSheetName:r,oldSheetIndex:i};t.editDataList.push({content:JSON.stringify([l]),opType:"cloneSheet",sheetName:n})})).catch((function(e){}))}},u={canUndo:!1,execute:function(e,r,n){var o=GC.Spread.Sheets.Commands;return o.startTransaction(e,r),t.insetMoreRowDialogVisible=!0,t.insertTopRows=!0,t.insertRowCol="插入行数",o.endTransaction(e,r),!0}},d={canUndo:!1,execute:function(e,r){var n=GC.Spread.Sheets.Commands;return n.startTransaction(e,r),t.insertRowCol="插入列数",t.insertTopRows=!1,t.insetMoreRowDialogVisible=!0,n.endTransaction(e,r),!0}},f={canUndo:!1,execute:function(e,r){var n=GC.Spread.Sheets.Commands;return n.startTransaction(e,r),t.insertRowCol="插入列数",t.insertTopRows=!0,t.insetMoreRowDialogVisible=!0,n.endTransaction(e,r),!0}},m={canUndo:!1,execute:function(e,r){var n=GC.Spread.Sheets.Commands;n.startTransaction(e,r);var o=e.getActiveSheet(),a=o.getActiveColumnIndex(),i=o.getActiveRowIndex(),s=o.getHyperlink(i,a);t.$refs.editor.setHyperlinkShow();var l=s.url,c=s.tooltip;return t.$refs.editor.HyperlinkCurrentCellV=o.getText(i,a),l.includes("sjs://")?(t.$refs.editor.$refs.hyperlinkC.webValue="DOCUMENT",t.$refs.editor.$refs.hyperlinkC.chooseSheetV=c.substring(3)):(t.$refs.editor.$refs.hyperlinkC.webValue="WEB",t.$refs.editor.$refs.hyperlinkC.HyperlinkTxt=s.url),n.endTransaction(e,r),!0}};e.register("editHyperlink",m),e.register("gc.SN.contextMenu.insertMoreRows",i),e.register("gc.SN.contextMenu.insertColumns",f),e.register("gc.SN.spread.contextMenu.hideSheet",s),e.register("gc.SN.spread.contextMenu.unhideSheet",l),e.register("SnSheetCopy",c,null,!1,!1,!1,!1),e.register("SnColumnWidth",r,null,!1,!1,!1,!1),e.register("SnRowHeight",o,null,!1,!1,!1,!1),e.register("insertTopRows",u,null,!1,!1,!1,!1),e.register("insertAfterCols",d,null,!1,!1,!1,!1)},c=function(e){var t=document.querySelector(".floatImg");e.onmousemove=function(e){var r=e.clientX,n=e.clientY;r+=t.offsetWidth/4,t.style.left=r+"px",t.style.top=n+"px",t.style.display="block"}},u=function(e,t){GC.Spread.Sheets.StatusBar.StatusItem.call(this,e,t)};u.prototype=new GC.Spread.Sheets.StatusBar.StatusItem,u.prototype.onCreateItemView=function(e){var t=this.contentDiv=document.createElement("div");t.innerHTML='<span>准备加载</span>\n                    <span style="width: 150px;height: 9px;border: solid 1px #217346;display: none;margin-left: 10px; line-height: 0px;">\n                        <span style="width: 93px;height: 9px;background-color: #217346;display: inline-block;"></span>\n                    </span>',t.style.padding="0 3px",e.appendChild(t)},u.prototype.updateProgress=function(e){e*=100,this.contentDiv.children[0].innerText="加载中: "+e.toFixed(2)+"%",this.contentDiv.children[1].style.display="inline-block",this.contentDiv.children[1].children[0].style.width=1.5*e+"px"},u.prototype.updateText=function(e){this.contentDiv.children[0].innerText=e,this.contentDiv.children[0].style.color="#217346",this.contentDiv.children[1].style.display="none"}},"4df1":function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n=r("53ca"),o=r("b85c"),a=(r("ac1f"),r("1276"),r("c740"),r("caad"),r("2532"),r("d3b7"),r("ddb0"),r("bf19"),r("ca00")),i=function(e){var t={name:"",size:"",style:"",weight:""},r=e.split(" "),n=/^\d+(|\.\d+)(pt|px)(|\/\d+(|\.\d+)(pt|px))$/gi;t.name=r[r.length-1];var o=r.findIndex((function(e,t,r){return n.test(e)}));return-1!==o&&(t.size=Object(a["h"])(r[o])),t.style=r.includes("italic")?"italic":"normal",t.weight=r.includes("700")?"bold":"normal",t},s=function(e){var t={},r=["borderBottom","borderTop","borderRight","borderLeft"];function n(r){var n={style:0,color:""};if(e[r]()){var o=e[r](),a=o.style,i=o.color;t[r]={style:a,color:i}}else t[r]=n}for(var o=0;o<r.length;o++)n(r[o]);return t},l=function(e){var t={underline:!1,strikethrough:!1};return 1===e&&(t.underline=!0),2===e&&(t.strikethrough=!0),3===e&&(t.strikethrough=t.underline=!0),t},c=function(e,t,r){e=e||GC.Spread.Sheets.findControl(document.getElementById("upss"));var n=e.getSheetFromName(t),a=[];r=r.constructor!==Array?[r]:r;for(var i=0;i<r.length;i++){var s=r[i],l=s.row,c=s.rowCount,u=s.col,d=s.colCount;if(l=-1===l?0:l,u=-1===u?0:u,1!=c||1!=d){var f,m=n.getSpans(),h=Object(o["a"])(m.values());try{for(h.s();!(f=h.n()).done;){var p=f.value,g=p["row"],v=p["col"];u<=v&&v<u+d&&l<=g&&g<l+c&&a.push(p)}}catch(w){h.e(w)}finally{h.f()}}}return a},u=function(e,t,r){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",a=e||GC.Spread.Sheets.findControl(document.getElementById("upss")),c=a.getSheetFromName(t),u=[],d=0;d<r.length;d++){var f=r[d],m=f.row,h=f.rowCount,p=f.col,g=f.colCount;m=-1===m?0:m,p=-1===p?0:p;for(var v=m;v<m+h;v++)for(var w=p;w<p+g;w++){var C=c.getCell(v,w),b={row:v,col:w};if("all"===o){b.text=C.text()||"",C.formula()&&(b.formula=C.formula());var S=C.formatter(),y=C.value();(y||S)&&(b.valueClass="object"===Object(n["a"])(y)?y instanceof Date?"date":"":Object(n["a"])(y),"object"===Object(n["a"])(y)&&y instanceof Date&&(b.numValue=new Date(y).getTime())),b.formatter=S||"none",C.foreColor()&&(b.foreColor=C.foreColor()),C.backColor()&&(b.backColor=C.backColor()),b.locked=C.locked();var x=C.textDecoration(),N=l(x);b.textDecoration=x&&0!=x?x:0,b.font=C.font(),b.fontStyle=i(C.font()),b.border=s(C),C.validator()&&(b.validator=C.validator().toJSON());var T=C.hAlign(),O=C.vAlign(),R=C.wordWrap();Object.assign(b,{hAlign:T,vAlign:O,wordWrap:R},N)}else{if("function"==typeof C[o]){var k=C[o]();b[o]=k,null!==k&&void 0!==k||(b[o]="none")}if("textDecoration"===o){var I=C.textDecoration(),F=l(I);Object.assign(b,F),b[o]=I&&0!=I?I:0}if("text"===o){b.text=C.text();var j=C.formula();j&&(b.formula=j);var A=C.value();(A||C.formatter())&&(b.valueClass="object"===Object(n["a"])(A)?A instanceof Date?"date":"":Object(n["a"])(A))}"font"===o&&(b.fontStyle=i(C.font())),"border"===o&&(b.border=s(C))}u.push(b)}}return u},d=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"getRowHeight";e=e||GC.Spread.Sheets.findControl(document.getElementById("upss"));var a=e.getSheetFromName(t),i=[];if("row"in r[0]){var s,l=Object(o["a"])(r.values());try{for(l.s();!(s=l.n()).done;){var c=s.value,u=c.row,d=c.rowCount;u=-1===u?0:u,d=d||1;for(var f=u;f<u+d;f++){var m=a[n](f);i.push({row:f,height:m})}}}catch(S){l.e(S)}finally{l.f()}}else{var h,p=Object(o["a"])(r.values());try{for(p.s();!(h=p.n()).done;)for(var g=h.value,v=g.firstRow,w=g.lastRow,C=v;C<=w;C++){var b=a[n](C);i.push({row:C,height:b})}}catch(S){p.e(S)}finally{p.f()}}return i},f=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"getColumnWidth";e=e||GC.Spread.Sheets.findControl(document.getElementById("upss"));var o=e.getSheetFromName(t),a=[];if("col"in r[0])for(var i=0;i<r.length;i++){var s=r[i],l=s.col,c=s.colCount;l=-1===l?0:l,c=c||1;for(var u=l;u<l+c;u++){var d=o[n](u);a.push({col:u,width:d})}}else for(var f=0;f<r.length;f++)for(var m=r[f],h=m.firstCol,p=m.lastCol,g=h;g<=p;g++){var v=o[n](g);a.push({col:g,width:v})}return a}},"4df4":function(e,t,r){"use strict";var n=r("0366"),o=r("7b0b"),a=r("9bdd"),i=r("e95a"),s=r("50c4"),l=r("8418"),c=r("35a1");e.exports=function(e){var t,r,u,d,f,m,h=o(e),p="function"==typeof this?this:Array,g=arguments.length,v=g>1?arguments[1]:void 0,w=void 0!==v,C=c(h),b=0;if(w&&(v=n(v,g>2?arguments[2]:void 0,2)),void 0==C||p==Array&&i(C))for(t=s(h.length),r=new p(t);t>b;b++)m=w?v(h[b],b):h[b],l(r,b,m);else for(d=C.call(h),f=d.next,r=new p;!(u=f.call(d)).done;b++)m=w?a(d,v,[u.value,b],!0):u.value,l(r,b,m);return r.length=b,r}},6062:function(e,t,r){"use strict";var n=r("6d61"),o=r("6566");e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),o)},"61ee":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ux-drawer",{attrs:{closable:"","wrapper-class":"historyDrawer"},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[r("span",{staticStyle:{"font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[e._v("历史记录")]),r("ux-radio-group",{staticStyle:{margin:"5px 10px",display:"flex","justify-content":"space-around"},on:{change:e.onChangeQueryType},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[r("ux-radio-button",{staticStyle:{"border-radius":"15px",background:"gainsboro"},attrs:{value:"detail"}},[e._v("操作")]),r("ux-radio-button",{staticStyle:{"border-radius":"15px",background:"gainsboro"},attrs:{value:"hour"}},[e._v("小时")]),r("ux-radio-button",{staticStyle:{"border-radius":"15px",background:"gainsboro"},attrs:{value:"day"}},[e._v("天")])],1),e._l(e.historyList,(function(t,n){var o=t.docId,a=t.revision,i=t.fullName,s=t.opType,l=t.createTime;return r("li",{key:n,staticClass:"list",style:{background:e.revisionId==a?"#B6B2FE":null},on:{mouseover:function(t){return e.onMouseOver(t)},mouseout:function(t){return e.onMouseOut(t)},click:function(t){return e.preview(o,a)}}},["detail"===e.queryType?r("div",{staticClass:"black",staticStyle:{"font-size":"14px"}},[r("b",[e._v(e._s(i))]),r("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(e.opTypeMapName[s]?e.opTypeMapName[s]:"编辑"))])]):e._e(),"detail"===e.queryType?r("div",{staticClass:"gray"},[e._v(e._s(e.convertCreateTime(l)))]):"hour"===e.queryType?r("b",{staticClass:"gray",staticStyle:{"font-size":"14px"}},[e._v(e._s(e.convertCreateTime(l)))]):r("b",{staticClass:"gray",staticStyle:{"font-size":"14px"}},[e._v(e._s(e.convertCreateDay(l)))])])})),"detail"===e.queryType?r("li",{staticStyle:{padding:"5px 0 20px 0","text-align":"center",color:"darkgray"}},[e._v("展示1000条以内的记录")]):"hour"===e.queryType?r("li",{staticStyle:{padding:"5px 0 20px 0","text-align":"center",color:"darkgray"}},[e._v("展示7天内的记录")]):"day"===e.queryType?r("li",{staticStyle:{padding:"5px 0 20px 0","text-align":"center",color:"darkgray"}},[e._v("展示所有记录")]):e._e()],2)],1)},o=[],a=r("1da1"),i=(r("ac1f"),r("5319"),r("b0c0"),r("96cf"),r("b775")),s={addColumns:"插入列",addRows:"插入行",addSheet:"新建页签",fill:"填充",autoFitRow:"自动调整行高","gc.spread.contextMenu.clearContents":"清除内容","designer.clearFormat":"橡皮檫",clearValues:"清除值",deleteColumns:"删除列",deleteRows:"删除行","gc.spread.contextMenu.deleteSheet":"删除工作表",editCell:"编辑单元格","designer.freeze":"冻结","designer.mergeCenter":"合并单元格",painter:"格式刷",clipboardPaste:"粘贴",renameSheet:"重命名页签",resizeColumn:"调整列高",resizeRow:"调整行高",revert:"历史记录还原","designer.setBackColor":"背景颜色设置","designer.setBorder":"描边设置",setCells:"单元格设置","designer.setFontFamily":"字体设置","designer.setFontSize":"字号设置","designer.setFontStyle":"字体风格设置","designer.setFontWeight":"字体粗细设置","designer.setForeColor":"字体颜色设置","designer.setFormatter":"单元格类型设置","designer.setHAlign":"水平对齐设置","designer.sortRange":"排序","designer.setStrikethrough":"删除线设置","designer.setUnderline":"下划线设置","designer.setVAlign":"垂直对齐设置","designer.setWordWrap":"自动换行设置","designer.unfreeze":"取消冻结","designer.unmergeCells":"取消合并单元格","designer.insertPicture":"插入图片",setHyperlink:"设置超链接",clearHyperlink:"取消超链接",deleteImage:"删除图片",resizeImage:"修改图片",copyImage:"复制图片",insertCellImage:"插入单元格图片",transformToCellImage:"转为单元格图片",transformToImage:"转为浮动图片",deleteCellImage:"删除单元格图片"},l={props:["value","revisionId","editing"],data:function(){return{isShow:!1,queryType:"detail",historyList:[],opTypeMapName:s,id:this.revisionId}},watch:{revisionId:function(e,t){this.id=e}},created:function(){this.queryType=this.value},methods:{show:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.isShow=!0,t.docId=null!=e?e:t.docId,r.next=4,Object(i["a"])("/api/file/history/getByPage",{docId:t.docId,queryType:t.queryType,pageNum:0,pageSize:1e3,limit:1e3});case 4:n=r.sent,t.historyList=n.list;case 6:case"end":return r.stop()}}),r)})))()},convertCreateTime:function(e){var t=moment(e).calendar(null,{nextWeek:e,nextDay:e,sameDay:"今天 HH:mm:ss",lastDay:"昨天 HH:mm:ss",lastWeek:e,sameElse:e});return t},convertCreateDay:function(e){var t=moment(e).calendar(null,{nextWeek:"YYYY-MM-DD",nextDay:"YYYY-MM-DD",sameDay:"今天",lastDay:"昨天",lastWeek:"YYYY-MM-DD",sameElse:"YYYY-MM-DD"});return t},onChangeQueryType:function(e){this.$emit("input",e),this.queryType=e,this.show()},onMouseOver:function(e){var t=e.currentTarget.className;e.currentTarget.className=t+" chooselist"},onMouseOut:function(e){var t=e.currentTarget.className;t=t.replace("chooselist",""),e.currentTarget.className=t},preview:function(e,t){var r=this.$route,n=r.name,o=r.fullPath,a=r.query;this.$router.push({name:"onlineHistory",params:{id:e,revisionId:t},query:{fromPath:"onlineHistory"!=n?encodeURIComponent(o):a.fromPath}}),this.id=t,this.$emit("on-change",t)}}},c=l,u=(r("7671"),r("2877")),d=Object(u["a"])(c,n,o,!1,null,"27b3cc01",null),f=d.exports;t["a"]=f},6566:function(e,t,r){"use strict";var n=r("9bf2").f,o=r("7c73"),a=r("e2cc"),i=r("0366"),s=r("19aa"),l=r("2266"),c=r("7dd0"),u=r("2626"),d=r("83ab"),f=r("f183").fastKey,m=r("69f3"),h=m.set,p=m.getterFor;e.exports={getConstructor:function(e,t,r,c){var u=e((function(e,n){s(e,u,t),h(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=n&&l(n,e[c],{that:e,AS_ENTRIES:r})})),m=p(t),g=function(e,t,r){var n,o,a=m(e),i=v(e,t);return i?i.value=r:(a.last=i={index:o=f(t,!0),key:t,value:r,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=i),n&&(n.next=i),d?a.size++:e.size++,"F"!==o&&(a.index[o]=i)),e},v=function(e,t){var r,n=m(e),o=f(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return a(u.prototype,{clear:function(){var e=this,t=m(e),r=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete r[n.index],n=n.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,r=m(t),n=v(t,e);if(n){var o=n.next,a=n.previous;delete r.index[n.index],n.removed=!0,a&&(a.next=o),o&&(o.previous=a),r.first==n&&(r.first=o),r.last==n&&(r.last=a),d?r.size--:t.size--}return!!n},forEach:function(e){var t,r=m(this),n=i(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:r.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!v(this,e)}}),a(u.prototype,r?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),d&&n(u.prototype,"size",{get:function(){return m(this).size}}),u},setStrong:function(e,t,r){var n=t+" Iterator",o=p(t),a=p(n);c(e,t,(function(e,t){h(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){var e=a(this),t=e.kind,r=e.last;while(r&&r.removed)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),u(t)}}},"6b75":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,"a",(function(){return n}))},"6d61":function(e,t,r){"use strict";var n=r("23e7"),o=r("da84"),a=r("94ca"),i=r("6eeb"),s=r("f183"),l=r("2266"),c=r("19aa"),u=r("861d"),d=r("d039"),f=r("1c7e"),m=r("d44e"),h=r("7156");e.exports=function(e,t,r){var p=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),v=p?"set":"add",w=o[e],C=w&&w.prototype,b=w,S={},y=function(e){var t=C[e];i(C,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})},x=a(e,"function"!=typeof w||!(g||C.forEach&&!d((function(){(new w).entries().next()}))));if(x)b=r.getConstructor(t,e,p,v),s.REQUIRED=!0;else if(a(e,!0)){var N=new b,T=N[v](g?{}:-0,1)!=N,O=d((function(){N.has(1)})),R=f((function(e){new w(e)})),k=!g&&d((function(){var e=new w,t=5;while(t--)e[v](t,t);return!e.has(-0)}));R||(b=t((function(t,r){c(t,b,e);var n=h(new w,t,b);return void 0!=r&&l(r,n[v],{that:n,AS_ENTRIES:p}),n})),b.prototype=C,C.constructor=b),(O||k)&&(y("delete"),y("has"),p&&y("get")),(k||T)&&y(v),g&&C.clear&&delete C.clear}return S[e]=b,n({global:!0,forced:b!=w},S),m(b,e),g||r.setStrong(b,e,p),b}},"74e2":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d3b7"),r("25f0"),r("b680");var n={S4:function(){return(65536*(1+Math.random())).toFixed().toString(16).substring(1)},guid:function(){return n.S4()+n.S4()+"-"+n.S4()+"-"+n.S4()+"-"+n.S4()+"-"+n.S4()+n.S4()+n.S4()}}},7671:function(e,t,r){"use strict";r("85bf")},"85bf":function(e,t,r){},"8a79":function(e,t,r){"use strict";var n=r("23e7"),o=r("06cf").f,a=r("50c4"),i=r("5a34"),s=r("1d80"),l=r("ab13"),c=r("c430"),u="".endsWith,d=Math.min,f=l("endsWith"),m=!c&&!f&&!!function(){var e=o(String.prototype,"endsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!m&&!f},{endsWith:function(e){var t=String(s(this));i(e);var r=arguments.length>1?arguments[1]:void 0,n=a(t.length),o=void 0===r?n:d(a(r),n),l=String(e);return u?u.call(t,l,o):t.slice(o-l.length,o)===l}})},"9bdd":function(e,t,r){var n=r("825a"),o=r("2a62");e.exports=function(e,t,r,a){try{return a?t(n(r)[0],r[1]):t(r)}catch(i){throw o(e),i}}},a15b:function(e,t,r){"use strict";var n=r("23e7"),o=r("44ad"),a=r("fc6a"),i=r("a640"),s=[].join,l=o!=Object,c=i("join",",");n({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(a(this),void 0===e?",":e)}})},a434:function(e,t,r){"use strict";var n=r("23e7"),o=r("23cb"),a=r("a691"),i=r("50c4"),s=r("7b0b"),l=r("65f0"),c=r("8418"),u=r("1dde"),d=u("splice"),f=Math.max,m=Math.min,h=9007199254740991,p="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var r,n,u,d,g,v,w=s(this),C=i(w.length),b=o(e,C),S=arguments.length;if(0===S?r=n=0:1===S?(r=0,n=C-b):(r=S-2,n=m(f(a(t),0),C-b)),C+r-n>h)throw TypeError(p);for(u=l(w,n),d=0;d<n;d++)g=b+d,g in w&&c(u,d,w[g]);if(u.length=n,r<n){for(d=b;d<C-n;d++)g=d+n,v=d+r,g in w?w[v]=w[g]:delete w[v];for(d=C;d>C-n+r;d--)delete w[d-1]}else if(r>n)for(d=C-n;d>b;d--)g=d+n-1,v=d+r-1,g in w?w[v]=w[g]:delete w[v];for(d=0;d<r;d++)w[d+b]=arguments[d+2];return w.length=C-n+r,u}})},a630:function(e,t,r){var n=r("23e7"),o=r("4df4"),a=r("1c7e"),i=!a((function(e){Array.from(e)}));n({target:"Array",stat:!0,forced:i},{from:o})},a8ef:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a}));var n=["cut","gc.spread.contextMenu.cut","gc.spread.contextMenu.clearContents","paste","designer.copy","gc.spread.contextMenu.copy"],o={columnWidth:{text:"列宽...",name:"SnColumnWidth",command:"SnColumnWidth",workArea:"colHeader"},rowHeight:{text:"行高...",name:"SnRowHeight",command:"SnRowHeight",workArea:"rowHeader"},sheetCopy:{text:"复制",name:"SnSheetCopy",command:"SnSheetCopy",workArea:"sheetTab"},insertRowsTopMenu:{text:"向上插入行",name:"insertTopRows",workArea:"rowHeader",command:"insertTopRows"},insertAfterColumns:{text:"向右插入列",name:"insertAfterCols",workArea:"colHeader",command:"insertAfterCols"},editHyperlink:{text:"编辑超链接",name:"editHyperlink",workArea:"viewport",command:"editHyperlink"},delHyperlink:{text:"取消超链接",name:"delHyperlink",workArea:"viewport",command:"clearHyperlink"}},a=["resizeRow","resizeColumn","designer.mergeCenter","designer.unmergeCells","mergeCenter","unmergeCells"]},b1cd:function(e,t,r){"use strict";r.d(t,"f",(function(){return s})),r.d(t,"k",(function(){return l})),r.d(t,"l",(function(){return c})),r.d(t,"e",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return m})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return p})),r.d(t,"h",(function(){return v})),r.d(t,"a",(function(){return w})),r.d(t,"g",(function(){return C})),r.d(t,"c",(function(){return b}));var n=r("1da1"),o=r("5530"),a=(r("96cf"),r("b0c0"),r("159b"),r("d81d"),r("99af"),r("a434"),r("bf19"),r("b64b"),r("74e2")),i=r("b893");function s(e,t,r){var n=e.getSheetFromName(t.sheetName),o=n.getColumnWidth(t.col),a=n.getRowHeight(t.row);!1!==r&&(o<100&&n.setColumnWidth(t.col,100),a<100&&n.setRowHeight(t.row,100));var i=n.getCell(t.row,t.col);i.backgroundImage(t.src),i.backgroundImageLayout(2),t.value=i.value(),i.value(null),n.getCellType(t.row,t.col)instanceof GC.Spread.Sheets.CellTypes.CheckBox&&w(e,{sheetName:t.sheetName,ranges:[{row:t.row,rowCount:1,col:t.col,colCount:1}]})}function l(e,t){var r,n=e.getSheetFromName(t.sheetName),a=n.pictures.all();a.every((function(e){var t=e.isSelected();return t&&(r=e),!t})),r&&(t.pictureName=r.name(),t.row=r.startRow(),t.col=r.startColumn(),t.value=n.getCell(t.row,t.col).value(),s(e,Object(o["a"])(Object(o["a"])({},t),{},{src:r.src()})),n.pictures.remove(t.pictureName))}function c(e,t){return u.apply(this,arguments)}function u(){return u=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n,o,a,s,l,c,u,d,f,m,h,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getSheetFromName(r.sheetName),o=r.startRow,a=r.startCol,s=n.getCell(o,a),l=s.backgroundImage(),s.backgroundImage(null),e.next=7,Object(i["h"])(l);case 7:return c=e.sent,u=c.ratio,d=Object(i["g"])(n.getColumnWidth(a),n.getRowHeight(o),u),f=d.width,m=d.height,h=d.offsetX,p=d.offsetY,e.next=12,Object(i["j"])(n,{startRow:o,startColumn:a,pictureName:r.pictureName,src:l,startColumnOffset:h,startRowOffset:p,width:f,height:m});case 12:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function d(e,t){var r=e.getSheetFromName(t.sheetName),n=t.row,o=t.col,a=r.getCell(n,o);a.backgroundImage(null)}function f(e,t){var r=e.getSheetFromName(t.sheetName),n=t.row,o=t.col,a=t.value,i=t.HyperlinkTxt,s=t.tooltip,l=t.content;r.setValue(n,o,a),r.setHyperlink(n,o,{url:i,tooltip:s||l,linkColor:"#0066cc",visitedLinkColor:"#3399ff",target:GC.Spread.Sheets.CellTypes.HyperLinkTargetType.blank},GC.Spread.Sheets.SheetArea.viewport)}function m(e,t){var r=e.getSheetFromName(t.sheetName),n=t.row,o=t.col;r.clear(n,o,1,1,GC.Spread.Sheets.SheetArea.viewport,GC.Spread.Sheets.StorageType.hyperlink|GC.Spread.Sheets.StorageType.style)}function h(e,t){var r=e.getSheetFromName(t.sheetName),n=r.pictures.all(),a=[];n.forEach((function(n){var i={sheetName:t.sheetName,pictureName:n.name(),row:n.startRow(),col:n.startColumn()};i.value=r.getCell(i.row,i.col).value(),s(e,Object(o["a"])(Object(o["a"])({},i),{},{src:n.src()})),r.pictures.remove(i.pictureName),a.push(i)})),t.pictures=a}function p(e,t){return g.apply(this,arguments)}function g(){return g=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n,o,i,s,l,u,d,f,m,h,p,g,v,w,C,b,S,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(o=t.getSheetFromName(r.sheetName),i=o.toJSON(),s=(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.dataTable)||{},l=[],u=0,d=Object.keys(s);u<d.length;u++)for(f=d[u],m=s[f],h=0,p=Object.keys(m);h<p.length;h++)v=p[h],w=m[v],null!==w&&void 0!==w&&null!==(g=w.style)&&void 0!==g&&g.backgroundImage&&(C={sheetName:r.sheetName,startRow:parseInt(f),startCol:parseInt(v),pictureName:"picture_".concat(a["a"].guid())},l.push(C));r.pictures=l,b=0,S=l;case 7:if(!(b<S.length)){e.next=14;break}return y=S[b],e.next=11,c(t,y);case 11:b++,e.next=7;break;case 14:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function v(e,t){var r=e.getSheetFromName(t.sheetName),n=new GC.Spread.Sheets.CellTypes.CheckBox;t.ranges.forEach((function(e){var o=e.row,a=e.rowCount,s=void 0===a?1:a,l=e.col,c=e.colCount,u=void 0===c?1:c;Object(i["c"])(o,s,l,u,(function(e,o){var a=r.getCell(e,o);!t.flag&&a.value(!1),a.backgroundImage(null),r.setCellType(e,o,n),Object(i["r"])(r,e,o,{hAlign:GC.Spread.Sheets.HorizontalAlign.center,vAlign:GC.Spread.Sheets.VerticalAlign.center})}))}))}function w(e,t){var r=e.getSheetFromName(t.sheetName),n=new GC.Spread.Sheets.CellTypes.Text;t.ranges.forEach((function(e){var t=e.row,o=e.rowCount,a=e.col,s=e.colCount;Object(i["c"])(t,o,a,s,(function(e,t){r.setCellType(e,t,n)}))}))}function C(e,t){var r=e.getSheetFromName(t.sheetName);v(e,{sheetName:t.sheetName,ranges:t.ranges.map((function(e){var t=e.row,r=e.rowCount,n=e.col;return{row:t,rowCount:r,col:n,colCount:1}}))});var n=r.conditionalFormats,o=e.getNamedStyle("taskList");o||(o=new GC.Spread.Sheets.Style,o.name="taskList",o.textDecoration=GC.Spread.Sheets.TextDecorationType.lineThrough,e.addNamedStyle(o)),b(e,t),t.ranges.forEach((function(e){var t=e.col,r=e.row,a=e.rowCount,i=new GC.Spread.Sheets.Range(r,-1,a,-1),s=GC.Spread.Sheets.CalcEngine.rangeToFormula(new GC.Spread.Sheets.Range(r,t,1,1),0,0,GC.Spread.Sheets.CalcEngine.RangeReferenceRelative.allRelative);n.addFormulaRule("=$".concat(s,"=TRUE"),o,[i])}))}function b(e,t){var r=e.getSheetFromName(t.sheetName),n=r.conditionalFormats,o=n.getRules();o.forEach((function(e){var r=e.getExpected();if("taskList"==(null===r||void 0===r?void 0:r.name)){var n=e.ranges(),o=n.concat();o.forEach((function(e,r){t.ranges.forEach((function(t){var a=[e.row,t.row],i=[e.row+e.rowCount,t.row+t.rowCount];if(!(Math.max.apply(Math,a)>Math.min.apply(Math,i))){if(e.row>=t.row){if(e.row+e.rowCount<=t.row+t.rowCount)return void n.splice(r,1);var s=t.row+t.rowCount;return e.rowCount-=s-e.row,void(e.row=s)}if(e.row+e.rowCount<=t.row+t.rowCount)e.rowCount=t.row-e.row;else{var l=new GC.Spread.Sheets.Range(t.row+t.rowCount,-1,e.row+e.rowCount-(t.row+t.rowCount),-1);e.rowCount=t.row-e.row,o.splice(r,0,l),n.splice(r,0,l)}}}))}))}}))}},b775:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("1da1"),o=(r("96cf"),r("159b"),r("a27e")),a=(r("4328"),r("190b"),r("2c3c")),i=o["a"].interceptors,s=i["request"]["handlers"],l=(i["response"]["handlers"],o["a"].create());function c(e){if(null==e||null==e.data)throw a["a"].error("错误！网络返回数据为空"),new Error("错误！网络返回数据为空: ".concat(e));if("0"!==e.data.resultCode)throw a["a"].error(e.data.message),new Error("警告！网络返回数据异常: ".concat(e));return!0}function u(e,t){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l.get(t,{params:r});case 2:if(n=e.sent,!c(n)){e.next=5;break}return e.abrupt("return",n.data.data);case 5:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}s.forEach((function(e){var t=e.fulfilled,r=e.rejected;l.interceptors.request.use(t,r)}))},b85c:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0");var n=r("06c5");function o(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Object(n["a"])(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r["return"]||r["return"]()}finally{if(l)throw i}}}}},b893:function(e,t,r){"use strict";r.d(t,"e",(function(){return d})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return h})),r.d(t,"h",(function(){return p})),r.d(t,"g",(function(){return g})),r.d(t,"s",(function(){return C})),r.d(t,"p",(function(){return b})),r.d(t,"j",(function(){return S})),r.d(t,"k",(function(){return y})),r.d(t,"l",(function(){return x})),r.d(t,"a",(function(){return N})),r.d(t,"i",(function(){return T})),r.d(t,"m",(function(){return O})),r.d(t,"b",(function(){return I})),r.d(t,"f",(function(){return F})),r.d(t,"n",(function(){return j})),r.d(t,"q",(function(){return A})),r.d(t,"o",(function(){return M})),r.d(t,"r",(function(){return D}));var n=r("1da1"),o=r("53ca"),a=(r("96cf"),r("b0c0"),r("bf19"),r("d3b7"),r("b64b"),r("4de4"),r("159b"),r("ac1f"),r("1276"),r("8a79"),r("c740"),r("caad"),r("2532"),r("ca00")),i=r("bac1"),s=r("eaa2"),l=r("b1cd"),c=r("74e2"),u=r("d46e"),d=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cellUpdata",a={sheetName:r.name(),row:e,col:t,opType:n,value:"",valueType:{},validator:{}},i=r.getCell(e,t),s=i.text();a.value=s,"FALSE"===s&&(a.value=!1,a.valueType.type="boolean");var l=i.value();return l&&(a.valueType.type="object"===Object(o["a"])(l)?l instanceof Date?"date":"":Object(o["a"])(l),"object"===Object(o["a"])(l)&&l instanceof Date&&(a.numValue=new Date(l).getTime()),"number"===typeof l&&(a.numValue=l)),a.multi=!(!i.validator()&&!i.formula()),i.formatter()&&(a.valueType.formatter=i.formatter()),i.formula()&&null!==i.formula()&&(a.valueType.formula=a.value=i.formula()),a.validator=i.validator()?i.validator().toJSON():{},a},f=function(e,t,r){for(var n=e+t,o=e;o<n;o++){var a=r(o);if(!1===a)return a}},m=function(e,t,r,n,o){f(e,t,(function(e){return f(r,n,(function(t){return o(e,t)}))}))};function h(e){var t,r=e.data,n=e.sheetName||(e.undo&&r&&r[0]?r[0].sheetName:""),o=e.oldName||"";(n||o)&&(t=this.spread.getSheetFromName(n)||this.spread.getSheetFromName(o)),t&&n&&(e.undo?a["m"].call(this,s["a"],[e]):a["m"].call(this,i["a"],[e]))}var p=function(e){return new Promise((function(t){var r=new Image;r.src=e,r.naturalWidth?t({width:r.naturalWidth,height:r.naturalHeight,ratio:r.naturalWidth/r.naturalHeight}):r.onload=function(){t({width:r.width,height:r.height,ratio:r.width/r.height})}}))},g=function(e,t,r){var n=e/r,o=t*r,a=parseInt(Math.min(e,o)),i=parseInt(Math.min(t,n)),s=e-a,l=t-i;return{width:a,height:i,offsetX:s>0?parseInt(s/2):0,offsetY:l>0?parseInt(l/2):0}},v=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r,n){var o,a,i,s,u,d,f,m,h,v,C,b,S,y,x,N,T,O,R;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=t.getSheetFromName(r),a=0,i=Object.keys(n);case 2:if(!(a<i.length)){e.next=30;break}s=i[a],u=n[s],d=0,f=Object.keys(u);case 6:if(!(d<f.length)){e.next=27;break}if(h=f[d],v=u[h],null===v||void 0===v||null===(m=v.style)||void 0===m||!m.backgroundImage){e.next=23;break}return C={sheetName:r,startRow:parseInt(s),startCol:parseInt(h),pictureName:"CellImage".concat(c["a"].guid())},e.next=13,Object(l["l"])(t,C);case 13:return b=o.pictures.get(C.pictureName),e.next=16,p(b.src());case 16:S=e.sent,y=S.ratio,x=g(o.getColumnWidth(C.startCol),o.getRowHeight(C.startRow),y),N=x.width,T=x.height,O=x.offsetX,R=x.offsetY,O&&b.startColumnOffset(O),R&&b.startRowOffset(R),b.width(N),b.height(T);case 23:w(o,parseInt(s),parseInt(h));case 24:d++,e.next=6;break;case 27:a++,e.next=2;break;case 30:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),w=function(e,t,r){if(e.getCellType(t,r)instanceof GC.Spread.Sheets.CellTypes.CheckBox){var n=e.getValue(t,r)?1:0;e.setValue(t,r,n),e.setFormatter(t,r,'[=1]"☑";[=0]"☐";0;@')}},C=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,n,o,a,i,s,l,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=new GC.Spread.Sheets.Workbook(null,{allowExtendPasteRange:!0,scrollbarMaxAlign:!0,calcOnDemand:!0,newTabVisible:!1,allowUserDragDrop:!1,allowSheetReorder:!0,tabEditable:!1}),r.fromJSON(t,{doNotRecalculateAfterLoad:!0}),n=t.sheets,o=0,a=Object.keys(n);case 4:if(!(o<a.length)){e.next=13;break}return s=a[o],l=n[s],c=(null===l||void 0===l||null===(i=l.data)||void 0===i?void 0:i.dataTable)||{},e.next=10,v(r,s,c);case 10:o++,e.next=4;break;case 13:return u=r.toJSON(),r.destroy(),e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(e,t){if(e.startRow(t.startRow),e.startColumn(t.startColumn),e.startColumnOffset(t.startColumnOffset||0),e.startRowOffset(t.startRowOffset||0),e.dynamicSize(!!t.dynamicSize),t.endRow)return e.endRow(t.endRow),e.endColumn(t.endColumn),e.endColumnOffset(t.endColumnOffset),void e.endRowOffset(t.endRowOffset);t.width&&e.width(t.width),t.height&&e.height(t.height)},S=function(e,t){return new Promise((function(r){var n=e.pictures.add(t.pictureName,t.src);n.isVisible(!1),n.startRow(t.startRow),n.startColumn(t.startColumn),setTimeout((function(){b(n,t),n.isVisible(!0),r(n)}),50)}))},y=function(e,t,r,n){for(var o=0;o<t.length;o++){var a=t[o],i=a.col,s=a.colCount;i=-1===i?0:i,s=s||1,e[r](i,s)}n&&n()},x=function(e,t,r,n){for(var o=0;o<t.length;o++){var a=t[o],i=a.row,s=a.rowCount;i=-1===i?0:i,s=s||1,e[r](i,s)}n&&n()},N=function(e,t){t.forEach((function(t){var r=t.fromRangeRow,n=t.fromRangeCol,o=t.startRow,a=t.startCol,i=t.rowCount,s=t.colCount,l=t.CopyToOptions;o>=e.getRowCount()||Object(u["a"])({col:a,colCount:s,row:o,rowCount:i},{col:n,colCount:s,row:r,rowCount:i})||e.copyTo(r,n,o,a,i,s,l)}))},T=function(e){var t=e.toJSON(),r=t.src,n=t.startRow,o=t.startColumn,a=t.startColumnOffset,i=t.startRowOffset,s=t.endRow,l=t.endColumn,c=t.endColumnOffset,u=t.endRowOffset,d=t.name,f=t.width,m=t.height,h=r.substring(0,r.indexOf(";"));return{width:f,height:m,startRow:n,startColumn:o,endRow:s,endColumn:l,extension:h.substring(h.indexOf(":")+1,h.length),pictureName:d,startColumnOffset:a||0,startRowOffset:i||0,endColumnOffset:c||0,endRowOffset:u||0}};function O(e,t,r){for(var n=e.floatingObjects,o=[],a=t.getSheetFromName(r),i=0;i<n.length;i++){var s=a.pictures.get(n[i]).toJSON(),l=s.src;l=l.substring(0,l.indexOf(";")),l=l.substring(l.indexOf(":")+1,l.length);var c=s.startRow,u=s.startColumn,d=(s.startColumnOffset,s.startRowOffset),f=s.endRow,m=s.endColumn,h=(s.endColumnOffset,s.endRowOffset),p=s.name,g=s.width,v=s.height;o.push({imageIdOrPictureName:p,width:g,height:v,extension:l,pictureName:p,startRow:c,startColumn:u,startColumnOffset:a.pictures.get(n[i]).toJSON().startColumnOffset||0,startRowOffset:d||0,endRow:f,endColumn:m,endColumnOffset:a.pictures.get(n[i]).toJSON().endColumnOffset||0,endRowOffset:h||0})}return o}var R=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={sheetName:r.name(),row:e,col:t,value:"",cellStyle:{},border:{},valueType:{}},s=r.getCell(e,t);i.value=s.text();var l=s.value();if(s.foreColor()&&(i.cellStyle.foreColor=Object(a["c"])(s.foreColor())),s.backColor()&&(i.cellStyle.backColor=Object(a["c"])(s.backColor())),l&&(i.valueType.type="object"===Object(o["a"])(l)?l instanceof Date?"date":"":Object(o["a"])(l),"object"===Object(o["a"])(l)&&l instanceof Date&&(i.numValue=new Date(l).getTime())),s.font()){var c=s.font().split(" "),u={},d=/^\d+(|\.\d+)(pt|px)(|\/\d+(|\.\d+)(pt|px))$/gi,f=c[c.length-1];"monospace"===f&&c[c.length-2],f.endsWith(",")&&(f=f.substr(0,f.indexOf(","))),u.font=f;var m=c.findIndex((function(e,t,r){return d.test(e)}));u.fontSize=Object(a["h"])(c[m])+"",u.fontStyle=c.includes("italic")?"italic":"normal",c.includes("700")||c.includes("bold")?u.fontWeight="bold":u.fontWeight="normal",u.fontInfo=s.font(),i.cellStyle.font=u}return s.borderLeft()&&(i.border.borderLeft=s.borderLeft(),i.border.borderLeft.color=Object(a["c"])(s.borderLeft().color)),s.borderTop()&&(i.border.borderTop=s.borderTop()),s.borderRight()&&(i.border.borderRight=s.borderRight()),s.borderBottom()&&(i.border.borderBottom=s.borderBottom()),s.hAlign()&&(i.cellStyle.hAlign=s.hAlign()),s.vAlign()&&(i.cellStyle.vAlign=s.vAlign()),s.wordWrap()&&(i.cellStyle.wordWrap=s.wordWrap()),s.cellType()&&(i.cellType=s.cellType()),n&&(s.formula()&&null!==s.formula()&&(i.valueType.formula=s.formula()),s.validator()&&null!==s.validator()&&(i.valueType.validator=s.validator().toJSON()),i.locked=s.locked()),i},k=function(e,t,r){var n=r.getCell(e,t),o={row:e,col:t,value:"",valueType:{}};return o.value=n.text(),o.multi=!!n.formula(),n.formula()&&null!==n.formula()?(o.valueType.formula=o.value=n.formula(),o):""},I=function(e,t){var r=[],n=e.cellRange,o=e.sheet;n=Object(a["p"])(n,o),n=n.constructor!==Array?[n]:n;for(var i=0;i<n.length;i++){var s=n[i],l=s.col,c=s.row,u=s.colCount,d=s.rowCount;if(!0===t)for(var f=c;f<c+d;f++)for(var m=l;m<l+u;m++){var h=k(f,m,o);r.push(h)}else if("fill"===t)for(var p=c;p<c+d;p++)for(var g=l;g<l+u;g++){var v=R(p,g,o,!0);r.push(v)}else for(var w=c;w<c+d;w++)for(var C=l;C<l+u;C++){var b=R(w,C,o);r.push(b)}}return r},F=function(e,t){for(var r=GC.Spread.Sheets.findControl(document.getElementById("upss"))||GC.Spread.Sheets.findControl(document.getElementById("senupss")),n=r.getSheetFromName(t),a=[],i=0;i<e.length;i++)for(var s=e[i],l=s.row,c=s.rowCount,u=s.col,d=s.colCount,f=l;f<l+c;f++)for(var m=u;m<u+d;m++){var h=n.getCell(f,m),p={row:f,col:m},g=h.value();g&&(p.valueClass="object"===Object(o["a"])(g)?g instanceof Date?"date":"":Object(o["a"])(g),"object"===Object(o["a"])(g)&&g instanceof Date&&(p.numValue=new Date(g).getTime())),a.push(p)}return a},j=function(e,t){var r=t.col,n=t.colCount,o=t.row,a=t.rowCount,i={};return m(o,a,r,n,(function(t,r){var n=e.getCell(t,r),o=n.backgroundImage();o&&!i[o]&&(i[o]={startRow:t,startColumn:r,src:o})})),i},A=function(e,t,r){var n=e.getRowCount();t.forEach((function(t){var o=t.row,a=t.rowCount;o=-1===o?0:o,a=-1===a?n:a;for(var i=o;i<o+a;i++)e.setRowVisible(i,r)}))},M=function(e,t,r){var n=e.getColumnCount();t.forEach((function(t){var o=t.col,a=t.colCount;o=-1===o?0:o,a=-1===a?n:a;for(var i=o;i<o+a;i++)e.setColumnVisible(i,r)}))},D=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getStyle(t,r),a=new GC.Spread.Sheets.Style;for(var i in n)a[i]=n[i];if(o)for(var s in o)"_id"!==s&&void 0===a[s]&&(a[s]=o[s]);e.setStyle(t,r,a)}},bac1:function(e,t,r){"use strict";var n=r("5530"),o=r("b85c"),a=(r("caad"),r("2532"),r("bf19"),r("b0c0"),r("99af"),r("159b"),r("d3b7"),r("ddb0"),r("ca00")),i=r("4df1"),s=r("b1cd"),l=r("b893"),c=r("eaa2"),u="WS_COMMAND",d={designerCmds:GC.Spread.Sheets.Designer.spreadActions,getUpdataType:function(e){var t=e[0].opType,r=t;r.includes(".")&&(r=r.substr(r.lastIndexOf(".")+1,r.length));var n=["addRows","addColumns","deleteRows","deleteColumns"],o=["setForeColor","setBackColor","setFontWeight","setFontStyle","setUnderline","setStrikethrough","setFontSize","setFormatter","setHAlign","setVAlign","setTextOrientation","freeze","setFontFamily"];return n.includes(r)?"modifyRowsCol":o.includes(r)?"setSpreadCmmonMd":r},cloneSheet:function(e,t){var r=t[0],n=r.newSheetName,o=r.sheetName,a=r.oldSheetIndex,i=e.getSheetFromName(o),s=new GC.Spread.Sheets.Worksheet,l=i.toJSON();l.name=n,s.fromJSON(l),e.addSheet(a+1,s)},hideRows:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;Object(l["q"])(e.getSheetFromName(n),o,!1)},unhideRows:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;Object(l["q"])(e.getSheetFromName(n),o,!0)},hideColumns:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;Object(l["o"])(e.getSheetFromName(n),o,!1)},unhideColumns:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;Object(l["o"])(e.getSheetFromName(n),o,!0)},setSheetHidden:function(e,t){var r=t[0],n=r.sheetName,o=r.hidden;if(!o){var a=e.getSheetFromName(n);a.visible(!0)}},SnCurrentSheetCopy:function(e,t){var r=t[0],n=r.sheetName,o=r.pastedRanges,a=r.pasteOptions,i=r.fromRanges,s=r.isCutting,l=e.getSheetFromName(n);a.includes(".")&&(a=a.substr(a.lastIndexOf(".")+1,a.length));var c={pasteAll:1791,pasteFormula:2,pasteValues:1,pasteFormatting:96,pasteValuesFormatting:97,pasteFormulaFormatting:98};if(a=c[a],1==i.length)for(var u=i[0],d=u["row"],f=u["col"],m=u["rowCount"],h=u["colCount"],p=l.getColumnCount(),g=l.getRowCount(),v=0;v<o.length;v++){var w=o[v],C=w["row"],b=w["col"],S=w["rowCount"],y=w["colCount"];b+y>p&&l.addColumns(p,b+y-p),C+S>g&&l.addRows(g,C+S-g);for(var x=C;x<C+S;x+=m)for(var N=b;N<b+y;N+=h)!0===s?l.moveTo(d,f,x,N,m,h,a):l.copyTo(d,f,x,N,m,h,a)}else{var T=o[0],O=T["row"],R=T["col"],k=(T["rowCount"],T["colCount"]);if(1==k)for(var I=0,F=0;F<i.length;F++){var j=i[F],A=j["row"],M=j["col"],D=j["rowCount"],P=j["colCount"];F-1>=0&&(I=i[F-1].rowCount||0),!0===s?l.moveTo(A,M,O+I,R,D,P,a):l.copyTo(A,M,O+I,R,D,P,a)}else for(var E=0,L=0;L<i.length;L++){var V=i[L],H=V["row"],G=V["col"],z=V["rowCount"],W=V["colCount"];L-1>=0&&(E=i[L-1].colCount||0),!0===s?l.moveTo(H,G,O,R+E,z,W,a):l.copyTo(H,G,O,R+E,z,W,a)}}},SnCrossSheetCopy:function(e,t){var r=t[0],n=r.sheetName,o=r.fromRanges,a=r.pastedRanges,s=r.isCutting,l=r.fromSheetName,u=r.pasteOptions,f=Object(i["d"])(e,l,o,"all"),m=[],h=e.getSheetFromName(n);if(1==o.length){var p=o[0],g=(p["row"],p["col"],p["rowCount"]),v=p["colCount"],w=a[0],C=w["row"],b=w["col"],S=w["rowCount"];w["colCount"];C=-1===C?0:C,b=-1===b?0:b;for(var y={},x=C;x<C+S;x++)m.push({row:x,col:b});for(var N=0;N<f.length;N++)Object.assign(f[N],m[N]);y.data=[{sheetName:n,cells:f}],c["a"].setCells(e,[y]),u.includes(".")&&(u=u.substr(u.lastIndexOf(".")+1,u.length));var T={pasteAll:1791,pasteFormula:2,pasteValues:1,pasteFormatting:96,pasteValuesFormatting:97,pasteFormulaFormatting:98};u=T[u];for(var O=0;O<a.length;O++){var R=a[O],k=R.row,I=R.col,F=R.rowCount,j=R.colCount;k=-1===k?0:k,I=-1===I?0:I;for(var A=k;A<k+F;A+=g)for(var M=I;M<I+j;M+=v)console.log("row===".concat(A,"===col===").concat(M)),h.copyTo(C,b,A,M,g,v,u)}}if(!0===s){d.designerCmds.clearFormat(e,{sheetName:l,selections:o});var D=e.getSheetFromName(l);o.forEach((function(e){D.clear(e.row,e.col,e.rowCount,e.colCount,3,GC.Spread.Sheets.StorageType.data)}))}},clipboardPaste:function(e,t){console.log(t[0]);var r=t[0],n=r.sheetName,o=r.fromRanges,a=r.pastedRanges,i=r.isCutting,s=r.clipboardText,l=r.fromSheetName,c=r.fromSheet,f=r.pasteOptions,m=r.clipboardHtml;if(l&&l===n)d.SnCurrentSheetCopy(e,t);else{console.log(f),f.includes(".")&&(f=f.substr(f.lastIndexOf(".")+1,f.length));var h={pasteAll:"all",pasteFormula:"formulas",pasteValues:"values",pasteFormatting:"formatting",pasteValuesFormatting:"valuesAndFormatting",pasteFormulaFormatting:"formulasAndFormatting"},p=[];f=h[f];for(var g=0;g<a.length;g++){var v=a[g],w=v["row"],C=v["col"],b=v["rowCount"],S=v["colCount"];p.push(new GC.Spread.Sheets.Range(w,C,b,S))}if(o){var y=o[0],x=y["row"],N=y["col"],T=y["rowCount"],O=y["colCount"];o=[new GC.Spread.Sheets.Range(x,N,T,O)]}l&&!c&&(c=e.getSheetFromName(l));var R=e.getSheetFromName(n),k=R.getActiveRowIndex(),I=R.getActiveColumnIndex();if(R.options.isProtected)R.options.isProtected=!1,e.commandManager().execute({cmd:"clipboardPaste",sheetName:n,fromSheet:c,fromRanges:o,pastedRanges:a,isCutting:i,clipboardText:s,clipboardHtml:m,editor:u,pasteOption:GC.Spread.Sheets.ClipboardPasteOptions[f]}),R.options.isProtected=!0;else{if(e.commandManager().execute({cmd:"clipboardPaste",sheetName:n,fromSheet:c,fromRanges:o,pastedRanges:p,isCutting:i,clipboardText:s,clipboardHtml:m,editor:u,pasteOption:GC.Spread.Sheets.ClipboardPasteOptions[f]}),o)for(var F=0;F<a.length;F++){var j=a[F],A=j.row,M=j.col,D=j.rowCount,P=j.colCount;R.getRange(A,M,D,P,3).wordWrap(!0)}R.setActiveCell(k,I)}}},setWordWrap:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=r.value,i=r.innerType,s=e.getSheetFromName(n);if(s.options.isProtected){s.options.isProtected=!1;for(var l=0;l<o.length;l++){var c=o[l],u=c.row,d=c.col,f=c.rowCount,m=c.colCount;s.getRange(u,d,f,m,3).wordWrap(a),"autofitRows"===i&&s.autoFitRow(u)}s.options.isProtected=!0}else for(var h=0;h<o.length;h++){var p=o[h],g=p.row,v=p.col,w=p.rowCount,C=p.colCount;s.getRange(g,v,w,C,3).wordWrap(a),"autofitRows"===i&&s.autoFitRow(g)}},sortRange:function(e,t){var r=t[0],n=r.sheetName,o=r.options,a=r.selections;d.designerCmds.sortRange(e,{sheetName:n,options:o,selections:[a],editor:u})},autoFitRow:function(e,t){var r=t[0],n=r.rows,o=r.sheetName;e.commandManager().execute({cmd:"autoFitRow",sheetName:o,rows:n,isColHeader:!1,autoFitType:GC.Spread.Sheets.AutoFitType.cell,editor:u})},setDataValidation:function(e,t){var r=GC.Spread.Sheets.DataValidation,n=t[0],o=n.sheetName,i=n.value,s=null,l=i.type,c=i.comparisonOperator,f=i.condition;for(var m in a["a"])c&&c==a["a"][m]&&(c=1*m);"LIST"==l&&(f.formula&&(s=r.createFormulaListValidator(f.formula)),f.expected&&(s=r.createListValidator(f.expected))),"INTEGER"==l&&(c||0==c||(c=6),s=7==c||6==c?r.createNumberValidator(c,f.item1.expected,f.item2.expected,!0):r.createNumberValidator(c,f.expected,null,!0)),"TEXT_LENGTH"==l&&(c||0==c||(c=6),7==c||6==c?(f.item1.expected=1*f.item1.expected,f.item2.expected=1*f.item2.expected,s=r.createTextLengthValidator(c,f.item1.expected,f.item2.expected)):(f.expected=1*f.expected,s=r.createTextLengthValidator(c,f.expected)));var h=e.getSheetFromName(o);console.log(1111),d.designerCmds.setDataValidation(e,{sheet:h,sheetName:o,selections:f.ranges,options:s,editor:u})},painter:function(e,t){var r=t[0].sheetName,n=e.getSheetFromName(r);n.isPaintSuspended(!0),n.options.isProtected?(n.options.isProtected=!1,Object(l["a"])(n,t[0].items),n.isPaintSuspended(!1),n.options.isProtected=!0):(Object(l["a"])(n,t[0].items),n.isPaintSuspended(!1))},clearStyle:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);o.forEach((function(e){a.clear(e.row,e.col,e.rowCount,e.colCount,3,GC.Spread.Sheets.StorageType.style)}))},renameSheet:function(e,t){var r=t[0],n=r.sheetName,o=r.oldName;e.commandManager().execute({cmd:"renameSheet",sheetName:o,name:n,editor:u}),this.isProtectedMap&&this.isProtectedMap[o]&&(this.isProtectedMap[n]=this.isProtectedMap[o],this.isProtectedMap[o]=null)},editCell:function(e,t){var r=t[0],n=r.sheetName,o=r.row,a=r.col,i=r.value,s=r.multi,l=e.getSheetFromName(n),c=l.getCell(o,a);if(c.backgroundImage()&&i&&c.backgroundImage(null),s){var d=t[0].valueType;"formula"in d&&(i="=".concat(d.formula))}l.options.isProtected?(l.options.isProtected=!1,e.commandManager().execute({cmd:"editCell",sheetName:n,row:o,col:a,newValue:i,editor:u}),l.options.isProtected=!0):e.commandManager().execute({cmd:"editCell",sheetName:n,row:o,col:a,newValue:i,editor:u})},clearValues:function(e,t){var r=t[0],n=r.sheetName,o=r.ranges;o=o.constructor!==Array?[o]:o;var a=e.getSheetFromName(n);a.options.isProtected?(a.options.isProtected=!1,e.commandManager().execute({cmd:"clearValues",sheetName:n,ranges:o,editor:u}),a.options.isProtected=!0):e.commandManager().execute({cmd:"clearValues",sheetName:n,ranges:o,editor:u})},clearContents:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;o=o.constructor!==Array?[o]:o;var a=e.getSheetFromName(n);a.options.isProtected?(a.options.isProtected=!1,e.commandManager().execute({cmd:"clearValues",sheetName:n,ranges:o,editor:u}),a.options.isProtected=!0):e.commandManager().execute({cmd:"clearValues",sheetName:n,ranges:o,editor:u})},resizeColumn:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.sheetName,o=r.columns,a=r["value"],i=e.getSheetFromName(n);i.options.isProtected?(i.options.isProtected=!1,e.commandManager().execute({cmd:"resizeColumn",sheetName:n,columns:o,size:a,isRowHeader:!1,editor:u}),i.options.isProtected=!0):e.commandManager().execute({cmd:"resizeColumn",sheetName:n,columns:o,size:a,editor:u,isRowHeader:!1})},resizeColumns:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.sheetName,a=r.columns,i=e.getSheetFromName(n);if(i.options.isProtected){i.options.isProtected=!1;var s,l=Object(o["a"])(a.values());try{for(l.s();!(s=l.n()).done;){var c=s.value;i.setColumnWidth(c.col,c.width,3)}}catch(m){l.e(m)}finally{l.f()}i.options.isProtected=!0}else{var u,d=Object(o["a"])(a.values());try{for(d.s();!(u=d.n()).done;){var f=u.value;i.setColumnWidth(f.col,f.width,3)}}catch(m){d.e(m)}finally{d.f()}}},resizeRow:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.sheetName,o=r.rows,a=r.size,i=e.getSheetFromName(n);i.options.isProtected?(i.options.isProtected=!1,e.commandManager().execute({cmd:"resizeRow",sheetName:n,rows:o,size:a,isColHeader:!1,editor:u}),i.options.isProtected=!0):e.commandManager().execute({cmd:"resizeRow",sheetName:n,rows:o,size:a,isColHeader:!1,editor:u})},setOutLines:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.index,o=r.count,a=r.setOutLinesType,i=r.sheetName,s={columnOutLines:"outlineColumn",rowOutLines:"outlineRow",rowUngroup:"removeRowOutline",columnUngroup:"removeColumnOutline"},l=e.getSheetFromName(i);l.suspendPaint(),e.commandManager().execute({cmd:s[a],sheetName:i,index:n,count:o,editor:u}),l.resumePaint()},resizeRows:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.sheetName,a=r.rows,i=e.getSheetFromName(n);if(i.options.isProtected){i.options.isProtected=!1;var s,l=Object(o["a"])(a.values());try{for(l.s();!(s=l.n()).done;){var c=s.value;i.setRowHeight(c.row,c.height,3)}}catch(m){l.e(m)}finally{l.f()}i.options.isProtected=!0}else{var u,d=Object(o["a"])(a.values());try{for(d.s();!(u=d.n()).done;){var f=u.value;i.setRowHeight(f.row,f.height,3)}}catch(m){d.e(m)}finally{d.f()}}},fill:function(e,t){var r=t[0],n=r.sheetName,o=r.startRange,a=r.fillDirection,i=r.autoFillType,s=r.fillRange;e.commandManager().execute({cmd:"fill",startRange:new GC.Spread.Sheets.Range(o.row,o.col,o.rowCount,o.colCount),fillRange:new GC.Spread.Sheets.Range(s.row,s.col,s.rowCount,s.colCount),editor:u,sheetName:n,fillDirection:a,autoFillType:i})},modifyRowsCol:function(e,t){var r=t[0],n=r.opType,o=r.rowOrCloIndex,a=r.count,i=r.sheetName,s=e.getSheetFromName(i);s.options.isProtected?(s.options.isProtected=!1,s[n](o,a),s.options.isProtected=!0):s[n](o,a)},deleteSheet:function(e,t){var r=t[0].sheetName,n=e.getSheetFromName(r);if(e.getSheetCount()>1&&n){var o=e.getSheetIndex(n.name()),a=n.isSelected();e.removeSheet(o),a&&e.setActiveSheetIndex(o>=e.getSheetCount()?o-1:o)}this.isProtectedMap&&this.isProtectedMap[r]&&(this.isProtectedMap[r]=null)},unfreeze:function(e,t){var r=t[0],n=r.selections,o=r.sheetName;d.designerCmds.unfreeze(e,{selections:[n],sheetName:o,editor:u})},createDefaultTable:function(e,t){var r=t[0],n=r.sheetName,o=r["exRange"],a=r.selections,i=e.getSheetFromName(n);d.designerCmds.createDefaultTable(e,{sheetName:n,selections:a,options:o,sheet:i})},insertSheet:function(e,t){var r=t[0],n=r.sheetName,o=r.selections;d.designerCmds.insertSheet(e,{sheetName:n,selections:o})},addSheet:function(e,t){var r=t[0].newSheetName,n=new GC.Spread.Sheets.Worksheet(r);n.setColumnCount(35,GC.Spread.Sheets.SheetArea.viewport),n.setRowCount(200,GC.Spread.Sheets.SheetArea.viewport),e.addSheet(1,n)},unmergeCells:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);o=o instanceof Array?o:[o],a.options.isProtected?(a.options.isProtected=!1,d.designerCmds.unmergeCells(e,{sheetName:n,selections:o,editor:u}),a.options.isProtected=!0):d.designerCmds.unmergeCells(e,{sheetName:n,selections:o,editor:u})},mergeCenter:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);o=o instanceof Array?o:[o];for(var i=0;i<o.length;i++)for(var s=o[i],l=-1===s.row?0:s.row,c=-1===s.col?0:s.col,f=0;f<s.rowCount;f++)for(var m=0;m<s.colCount;m++)a.getCell(l+f,c+m).vAlign(1);a.options.isProtected?(a.options.isProtected=!1,d.designerCmds.mergeCenter(e,{sheetName:n,selections:o,editor:u}),a.options.isProtected=!0):d.designerCmds.mergeCenter(e,{sheetName:n,selections:o,editor:u})},mergeCells:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);a.options.isProtected?(a.options.isProtected=!1,d.designerCmds.mergeCells(e,{sheetName:n,selections:o,editor:u}),a.options.isProtected=!0):d.designerCmds.mergeCells(e,{sheetName:n,selections:o,editor:u})},mergeAcross:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);a.options.isProtected?(a.options.isProtected=!1,d.designerCmds.mergeAcross(e,{sheetName:n,selections:o}),a.options.isProtected=!0):d.designerCmds.mergeAcross(e,{sheetName:n,selections:o})},setAutoFormula:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=r["formulaName"];d.designerCmds.setAutoFormula(e,{options:a,sheetName:n,selections:[o],editor:u})},setAutoFilter:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=r.isRibbonFilter;o[0].row=0===o[0].row||-1===o[0].row?1:o[0].row+1,d.designerCmds.setRowFilter(e,{sheetName:n,selections:o,options:a,editor:u})},clearFormat:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);a.options.isProtected?(a.options.isProtected=!1,d.designerCmds.clearFormat(e,{sheetName:n,selections:o,editor:u}),a.options.isProtected=!0):d.designerCmds.clearFormat(e,{sheetName:n,selections:o,editor:u})},setSpreadCmmonMd:function(e,t){var r=t[0].opType;r.includes("designer")&&(r=r.substr(r.indexOf(".")+1,r.length));var n=t[0],o=n.sheetName,a=n.selections,i=n["value"];"setFontSize"==r&&(i+="pt");var s=e.getSheetFromName(o);s.options.isProtected?(s.options.isProtected=!1,d.designerCmds[r](e,{sheetName:o,selections:a,options:i,editor:u}),s.options.isProtected=!0):d.designerCmds[r](e,{sheetName:o,selections:a,options:i,editor:u})},setBorder:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=r["value"],i=o[0],s=i.row,l=i.col,c=i.rowCount,f=i.colCount,m=[new GC.Spread.Sheets.Range(s,l,c,f)],h=new GC.Spread.Sheets.LineBorder("black",1);a.lineborder=h;var p=e.getSheetFromName(n);p.options.isProtected?(p.options.isProtected=!1,d.designerCmds.setBorder(e,{sheetName:n,selections:m,options:a,editor:u}),p.options.isProtected=!0):d.designerCmds.setBorder(e,{sheetName:n,selections:m,options:a,editor:u})},baseDialogCommand:function(e,t){e=e||GC.Spread.Sheets.findControl(document.getElementById("ss"));var r=t[0],n=r.sheetName,o=r.selections,a=r.value,i=r.execute;d.designerCmds.baseDialogCommand(e,{sheetName:n,selections:o,options:{value:a,execute:i}})},setSheetOrder:function(e,t){var r=t[0].sheetName;e.commandManager().execute({cmd:"navigationNextSheet",sheetName:r,editor:u})},insertPicture:function(e,t){var r=t[0],n=r.sheetName,o=r.imageAttributesList,a=e.getSheetFromName(n);o.forEach((function(e){Object(l["j"])(a,e)}))},deleteImage:function(e,t){for(var r=t[0],n=r.imageList,o=r.sheetName,a=e.getSheetFromName(o),i=0;i<n.length;i++)a.pictures.remove(n[i])},resizeImage:function(e,t){for(var r=t[0],n=r.imageAttributesList,o=r.sheetName,a=e.getSheetFromName(o),i=0;i<n.length;i++){var s=n[i].pictureName,c=a.pictures.get(s);c&&Object(l["p"])(c,n[i])}},insertCellImage:function(e,t){var r=t[0],n=r.sheetName,o=r["imageAttributes"],a=o.src,i=o.startColumn,l=o.startRow;s["f"](e,{sheetName:n,src:a,row:l,col:i})},transformToCellImage:function(e,t){var r=t[0],n=r.sheetName,o=r["imageAttributes"],a=o.col,i=o.pictureName,l=o.row,c=e.getSheetFromName(n),u=c.pictures.get(i);u&&(s["f"](e,{sheetName:n,col:a,row:l,src:u.src()}),c.pictures.remove(i))},batchTransformToCellImage:function(e,t){var r=t[0],n=r.sheetName,o=r.imageAttributesList,a=e.getSheetFromName(n);o.forEach((function(t){var r=a.pictures.get(t.pictureName);r&&(s["f"](e,{sheetName:n,pictureName:t.pictureName,col:t.startColumn,row:t.startRow,src:r.src()}),a.pictures.remove(t.pictureName))}))},transformToImage:function(e,t){var r=t[0],n=r.sheetName,o=r["imageAttributes"],a=o.startRow,i=o.pictureName,l=o.startColumn;s["l"](e,{sheetName:n,pictureName:i,startRow:a,startCol:l})},batchTransformToImage:function(e,t){var r=t[0],n=r.sheetName,o=r.imageAttributesList;o.forEach((function(t){s["l"](e,{sheetName:n,pictureName:t.pictureName,startRow:t.startRow,startCol:t.startColumn})}))},deleteCellImage:function(e,t){var r=t[0],n=r.sheetName,o=r["imageAttributes"],a=o.startRow,i=o.startColumn;s["e"](e,{sheetName:n,row:a,col:i})},setHyperlink:function(e,t){var r=t[0],n=r.linkAddress,o=(r.linkType,r["range"]),a=o.row,i=o.col,l=r.sheetName,c=r.value,u=r.linkToolTip;s["d"](e,{sheetName:l,row:a,col:i,value:c,HyperlinkTxt:n,content:n,tooltip:u})},clearHyperlink:function(e,t){s["b"](e,t[0])},copyCellImage:function(e,t){var r=t[0],n=r.sheetName,o=r["imageAttributes"],a=o.startRow,i=o.startColumn,s=o.ranges,l=e.getSheetFromName(n),c=l.getCell(a,i),u=c.backgroundImage();u&&s.forEach((function(e){var t=l.getCell(e.row,e.col);t.backgroundImage(u),t.backgroundImageLayout(2)}))},copyImage:function(e,t){var r=t[0],o=r.fromSheetName,a=r.imageAttributesList,i=r.sheetName,s=r.isCutting,c=e.getSheetFromName(o),u=e.getSheetFromName(i);a.forEach((function(e){var t=c.pictures.get(e.floatingObjects);t&&(Object(l["j"])(u,Object(n["a"])(Object(n["a"])({},e),{},{src:t.src()})),s&&c.pictures.remove(e.floatingObjects))}))},addCheckbox:function(e,t){s["h"](e,t[0])},insertTaskList:function(e,t){s["g"](e,t[0])},clearCellType:function(e,t){s["a"](e,t[0])}};t["a"]=d},bb2f:function(e,t,r){var n=r("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bf19:function(e,t,r){"use strict";var n=r("23e7");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},c740:function(e,t,r){"use strict";var n=r("23e7"),o=r("b727").findIndex,a=r("44d2"),i="findIndex",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(i)},ca00:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"h",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return d})),r.d(t,"m",(function(){return f})),r.d(t,"p",(function(){return m})),r.d(t,"o",(function(){return h})),r.d(t,"q",(function(){return p})),r.d(t,"j",(function(){return g})),r.d(t,"i",(function(){return v})),r.d(t,"l",(function(){return w})),r.d(t,"n",(function(){return C})),r.d(t,"r",(function(){return b})),r.d(t,"g",(function(){return y})),r.d(t,"k",(function(){return x})),r.d(t,"b",(function(){return O})),r.d(t,"d",(function(){return R}));var n=r("2909"),o=(r("99af"),r("fb6a"),r("a15b"),r("ac1f"),r("1276"),r("caad"),r("2532"),r("b680"),r("b64b"),r("159b"),r("5319"),r("bf19"),r("b0c0"),r("a8ef")),a=[{label:"常规",value:"general",type:"setFormatter"},{label:"纯文本",value:"@",type:"setFormatter"},{label:"数字",value:"0.00",type:"setFormatter"},{label:"数字(千分位)",value:'#,##0; (#,##0); "-"??;@',type:"setFormatter"},{label:"数字(千分位,小数点)",value:'#,##0.00; (#,##0.00); "-"??;@',type:"setFormatter"},{label:"百分比",value:"0%",type:"setFormatter"},{label:"百分比(小数点)",value:"0.00%",type:"setFormatter"},{label:"科学计数",value:"0.00E+00",type:"setFormatter"},{label:"人民币",value:"￥#,##0",type:"setFormatter"},{label:"人民币(小数点)",value:"￥#,##0.00",type:"setFormatter"},{label:"美元",value:"$#,##0",type:"setFormatter"},{label:"美元(小数点)",value:"$#,##0.00",type:"setFormatter"},{label:"时间",value:"h:mm:ss AM/PM",type:"setFormatter"},{label:"日期",value:"yyyy/m/d",type:"setFormatter"},{label:"日期时间",value:"yyyy/m/d h:mm;@",type:"setFormatter"}],i={1:"INTEGER",2:"INTEGER",3:"LIST",6:"TEXT_LENGTH"},s={0:"equalsTo",1:"notEqualsTo",2:"greaterThan",3:"greaterThanOrEqualsTo",4:"lessThan",5:"lessThanOrEqualsTo",6:"between",7:"notBetween"},l=function(e){e=e.toLowerCase();var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e&&t.test(e)){if(4===e.length){for(var r="#",n=1;n<4;n+=1)r+=e.slice(n,n+1).concat(e.slice(n,n+1));e=r}for(var o=[],a=1;a<7;a+=2)o.push(parseInt("0x"+e.slice(a,a+2)));return"rgb("+o.join(",")+")"}return e},c=function(e){var t=e.split("/")[0],r=t,n=localStorage.getItem("fontDPIRate");return t.includes("px")&&(t=t.substr(0,t.length-2),r=parseInt(t)*n,r!=parseInt(r)&&r.toFixed(1),r+="pt"),r=r.substr(0,r.length-2),1*r},u=function(){var e=[];if(void 0!=window.screen.deviceXDPI)e[0]=window.screen.deviceXDPI,e[1]=window.screen.deviceYDPI;else{var t=document.createElement("DIV");t.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e[0]=parseInt(t.offsetWidth),e[1]=parseInt(t.offsetHeight),t.parentNode.removeChild(t)}return e};String.prototype.visualLength=function(e,t){var r=$("#testTxtRuler").css({"font-size":e||"inherit","font-family":t||"inherit"});return r.text(this),r.width()};var d=function(e){var t=e.txt,r=e.size,n=e.family;r=r||12,n=n||"";var o=document.createElement("SPAN");o.id="testTxtRuler",o.style.cssText="white-space: nowrap;font-size: 12px;visibility:hidden",document.body.appendChild(o);var a=t.visualLength(r,n);return o.parentNode.removeChild(o),a},f=function(e,t){var r=this.spread||GC.Spread.Sheets.findControl(document.getElementById("upss")),a=r.undoManager(),i=a.Bc?Object(n["a"])(a.Bc):[],s=a.Ac?Object(n["a"])(a.Ac):[],l=e.getUpdataType(t);o["c"].includes(l)&&this.queryHighLightRect&&this.queryHighLightRect();var c=["addRows","addColumns","deleteRows","deleteColumns"];l in e&&(e[l].call(this,r,t),c.includes(l)?(a.Bc=[],a.Ac=[]):(a.Bc=i,a.Ac=s))},m=function(e,t){var r=[],n=t.getColumnCount(),o=t.getRowCount();if(e.constructor!==Array){var a=e.col,i=e.row,s=e.colCount,l=e.rowCount;return i=-1===i?0:i,a=-1===a?0:a,s=-1===s?n:s,l=-1===l?o:l,new GC.Spread.Sheets.Range(i,a,l,s)}for(var c=0;c<e.length;c++){var u=e[c],d=u.col,f=u.row,m=u.colCount,h=u.rowCount;f=-1===f?0:f,d=-1===d?0:d,m=-1===m?n:m,h=-1===h?o:h,r.push(new GC.Spread.Sheets.Range(f,d,h,m))}return r},h=function(e){return e.length<=1||e.reverse(),e},p=function(e){var t=e.type,r=e.comparisonOperator,n=e.condition;Object.keys(i).includes(t+"")&&(e.type=i[t]),1!=t&&6!=t&&2!=t||r||0==r||(r=6),(r||0===r)&&Object.keys(s).includes(r+"")&&(e.comparisonOperator=s[r]);var o=n.item1,a=n.item2;return o&&"compareType"in o&&Object.keys(s).includes(n.item1.compareType+"")&&(e.condition.item1.compareType=s[n.item1.compareType]),a&&"compareType"in a&&Object.keys(s).includes(n.item2.compareType+"")&&(e.condition.item2.compareType=s[n.item2.compareType]),o?("expected"in o&&(o.expected=o.expected+""),"expected"in a&&(a.expected=a.expected+"")):n.expected=n.expected+"",e},g=function(e,t){e.forEach((function(e){for(var r=e.lastCol,n=e.firstCol,o=n;o<=r;o++)t.setColumnWidth(o,20,3)}))},v=function(e){var t,r=null,n=null,o="normal",a="normal",i="normal",s="normal",l=e.split(/\s+/);while(t=l.shift())switch(t){case"normal":break;case"italic":case"oblique":o=t;break;case"small-caps":i=t;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":a=t;break;default:if(!n){var c=t.split("/");n=c[0],-1!==n.indexOf("px")&&(n=T(parseFloat(n))+"pt"),c.length>1&&(s=c[1],-1!==s.indexOf("px")&&(s=T(parseFloat(s))+"pt"));break}return r=t,l.length&&(r+=" "+l.join(" ")),{fontStyle:o,fontVariant:i,fontWeight:a,fontSize:n,lineHeight:s,fontFamily:r}}return{fontStyle:o,fontVariant:i,fontWeight:a,fontSize:n,lineHeight:s,fontFamily:r}},w=function(e,t){var r="spanState"+e,n=document.getElementById(r);if(n){var o=n.getAttribute("class");t&&!o.includes("spanState")&&n.setAttribute("class","".concat(o," spanState")),!t&&o.includes("spanState")&&n.setAttribute("class","".concat(o.replace(/spanState/g,"")))}},C=function(e,t){var r=e.getActualStyle(e.getActiveRowIndex(),e.getActiveColumnIndex());if(r){var n=r[t]||"#333333";return"backColor"!=t||r[t]||(n="#fff"),n}},b=function(e,t,r){var n=e.getActualStyle(t,r),o=GC.Spread.Sheets;if(w("Hyperlink",!1),e.getHyperlink(t,r)&&w("Hyperlink",!0),n){var i=n["font"],s=n["formatter"];n.foreColor;if(i){var l=v(i),c=l.fontWeight,u=l.fontStyle,d=l.fontFamily,f=l.fontSize;this.$children[1].fontFamliyValue=d.replace(/'/g,""),this.$children[1].fontSizeValue=parseFloat(f),w("Bold",["bold","bolder","700","800","900"].includes(c)),w("Italic","normal"!==u);var m=o.TextDecorationType.underline,h=o.TextDecorationType.lineThrough,p=(o.TextDecorationType.overline,o.TextDecorationType.doubleUnderline,n.textDecoration);w("Underline",p&&(p&m)===m),w("Strikethrough",p&&(p&h)===h)}if(s){var g="";a.forEach((function(e){e.value===s&&(g=e.label)})),g&&(this.$children[1].normalOperatorDefault=g),!g&&(this.$children[1].normalOperatorDefault="自定义")}else this.$children[1].normalOperatorDefault="常规"}},S={0:"anyValue",1:"createNumberValidator",2:"createNumberValidator",3:"createListValidator",4:"createDateValidator",5:"time",6:"createTextLengthValidator",7:"custom"},y=function(e,t){var r=e.getActiveRowIndex(),n=e.getActiveColumnIndex(),o=S[t.type()],a=s[t.comparisonOperator()];this.type=this.loadType=o;var i=t.value1(r,n),l=t.value2(r,n);"string"==typeof i&&i.includes("=")&&(i=i.substr(i.indexOf("=")+1)),"string"==typeof l&&l.includes("=")&&(l=l.substr(l.indexOf("=")+1));var c={type:a,value:i,lessThan:i,greaterThan:l};"createNumberValidator"==o&&(this.integerOperator=JSON.parse(JSON.stringify(c))),"createDateValidator"==o&&(this.dateOperator=JSON.parse(JSON.stringify(c))),"createTextLengthValidator"==o&&(this.textLengthOperator=JSON.parse(JSON.stringify(c))),"createListValidator"==o&&(this.dalaList.expected=i),this.validator.inputTitle=t.inputTitle()||"",this.validator.inputMessage=t.inputMessage()||"",this.validator.errorTitle=t.errorTitle()||"",this.validator.errorMessage=t.errorMessage()||""},x=function(){this.type="createListValidator",this.integerOperator.type="equalsTo",this.integerOperator.value=this.integerOperator.lessThan=0,this.integerOperator.greaterThan=0;var e=JSON.stringify(this.integerOperator);this.dateOperator=e,this.textLengthOperator=e,this.dalaList.expected="1,2,3",this.validator.inputTitle=this.validator.inputMessage=this.validator.errorTitle=this.validator.errorMessage=""},N=$("<span></span>");function T(e){N.css({"font-size":"96pt",display:"none"}),N.appendTo($(document.body));var t=N.css("font-size");if(-1!==t.indexOf("px")){var r=parseFloat(t);return Math.round(96*e/r)}return Math.round(72*e/96)}var O=function(e){var t=e["sheets"];for(var r in t){var n=t[r],o=n.rowCount,a=n.columnCount,i=Object.keys(t[r]);if(i.includes("floatingObjects")&&t[r].floatingObjects.length>5&&(this.loadingTxt="该表格带有多个图片，加载需要一定使时间......"),i.includes("rowFilter")){var s=t[r].rowFilter.range,l=s.row,c=s.rowCount;if(0===c){var u=Object.keys(t[r].data.dataTable);t[r].rowFilter.range.rowCount=1*u[u.length-1]-l+1}}o<100&&(t[r].rowCount=100),a<35&&(t[r].columnCount=35)}return e.allowExtendPasteRange=e.scrollbarMaxAlign=!0,e.newTabVisible=e.allowUserDragDrop=!1,e.allowSheetReorder=!0,e},R=function(){this.outLineInfo.colUngroup=this.outLineInfo.rowUngroup=!1;var e=this.spread.getActiveSheet(),t=e.getSelections()[0],r=e.rowOutlines.toJSON(),n=e.columnOutlines.toJSON(),o=t.row,a=t.rowCount,i=t.col,s=t.colCount;if(r){var l=r["items"],c=l.some((function(e){return-1!=e.level}));c&&(this.outLineInfo.rowUngroup=!0)}if(n){var u=n["items"],d=u.some((function(e){return-1!=e.level}));d&&(this.outLineInfo.colUngroup=!0)}-1===o?(this.outLineInfo.col=i,this.outLineInfo.colSet=!0,this.outLineInfo.rowSet=!1,this.outLineInfo.colCount=s,this.outLineInfo.endColTxt=e.getText(0,i+s-1,1),this.outLineInfo.colTxt=e.getText(0,i,1)):-1===i?(this.outLineInfo.colSet=!1,this.outLineInfo.rowSet=!0,this.outLineInfo.row=o,this.outLineInfo.rowCount=a):(this.outLineInfo.row=o,this.outLineInfo.colSet=this.outLineInfo.rowSet=!0,this.outLineInfo.rowCount=a,this.outLineInfo.col=i,this.outLineInfo.colCount=s,this.outLineInfo.endColTxt=e.getText(0,i+s-1,1),this.outLineInfo.colTxt=e.getText(0,i,1))}},d46e:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e,t){return(t.col<0||e.col<t.col+t.colCount&&t.col<e.col+e.colCount)&&(t.row<0||e.row<t.row+t.rowCount&&t.row<e.row+e.rowCount)}},d81d:function(e,t,r){"use strict";var n=r("23e7"),o=r("b727").map,a=r("1dde"),i=a("map");n({target:"Array",proto:!0,forced:!i},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},db90:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}},eaa2:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("5530"),o=r("b85c"),a=r("2909"),i=(r("caad"),r("2532"),r("b64b"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("4de4"),r("a630"),r("159b"),r("b893")),s=r("bac1"),l=r("b1cd"),c="WS_COMMAND",u={getUpdataType:function(e){var t=e[0],r=t.opType;return r.includes(".")&&(r=r.substr(r.lastIndexOf(".")+1,r.length)),r},setFormatter:function(e,t){for(var r=t[0].data,n=r[0],o=n.sheetName,a=n.cells,i=e.getSheetFromName(o),s=0;s<a.length;s++){var l=a[s],c=l.row,u=l.col,d=l.formatter,f=i.getCell(c,u);d="none"!==d?d:null,f.formatter(d)}},setCells:function(e,t){console.log(t);for(var r=t[0],n=r.data,i=(r.subOpType,n[0]),s=i.sheetName,l=i.cells,d=i.rows,f=i.columns,m=i.mergedRegions,h=e.getSheetFromName(s),p=0;p<l.length;p++){var g=l[p],v=g.row,w=g.col,C=h.getCell(v,w),b=new GC.Spread.Sheets.Style;h.setStyle(v,w,b,3);var S=Object.keys(l[p]),y=new Set(Object(a["a"])(S).filter((function(e){return!new Set(["text","formula","border","validator"]).has(e)})));S=Array.from(y);for(var x=2;x<S.length;x++){var N=S[x],T=l[p][N];T="none"===T?null:T,N in C&&"function"==typeof C[N]&&C[N](T)}if("text"in l[p]){var O=l[p].text;e.commandManager().execute({cmd:"editCell",sheetName:s,row:v,col:w,newValue:O,editor:c}),"formula"in l[p]&&(O=l[p].formula,C.formula(O))}if("border"in l[p]){var R=l[p].border;for(var k in R){var I=R[k],F=I.color,j=I.style;j&&C[k](new GC.Spread.Sheets.LineBorder(F,j))}}"validator"in l[p]&&u.setDataValidation(h,l[p].validator,{row:v,col:w,rowCount:1,colCount:1})}if(d){var A,M=Object(o["a"])(d.values());try{for(M.s();!(A=M.n()).done;){var D=A.value;h.autoFitRow(D.row),h.setRowHeight(D.row,D.height,3)}}catch($){M.e($)}finally{M.f()}}if(f){var P,E=Object(o["a"])(f.values());try{for(E.s();!(P=E.n()).done;){var L=P.value;h.setColumnWidth(L.col,L.width,3)}}catch($){E.e($)}finally{E.f()}}if(m&&m.length>0){var V,H=Object(o["a"])(m.values());try{for(H.s();!(V=H.n()).done;){var G=V.value,z=G.row,W=G.rowCount,B=G.col,U=G.colCount;h.addSpan(z,B,W,U,3)}}catch($){H.e($)}finally{H.f()}}},clipboardPaste:function(e,t){var r=t[0].data;function n(t,r,n){for(var o=e.getSheetFromName(r),i=0;i<t.length;i++){var s=null,l=t[i],d=l.row,f=l.col,m=o.getCell(d,f);s=new GC.Spread.Sheets.Style,n||o.setStyle(d,f,s,3),o.removeSpan(d,f);var h=Object.keys(t[i]),p=new Set(Object(a["a"])(h).filter((function(e){return!new Set(["text","formula","border","validator"]).has(e)})));h=Array.from(p);for(var g=2;g<h.length;g++){var v=h[g],w=t[i][v];w="none"===w?"":w,v in m&&"function"==typeof m[v]&&m[v](w)}if("text"in t[i]){var C=t[i].text;e.commandManager().execute({cmd:"editCell",sheetName:r,row:d,col:f,newValue:C,editor:c}),"formula"in t[i]&&(C=t[i].formula,m.formula(C))}if("border"in t[i]){var b=t[i].border;for(var S in b){var y=b[S],x=y.color,N=y.style;N&&m[S](new GC.Spread.Sheets.LineBorder(x,N))}}o.setDataValidator(d,f,1,1,null),"validator"in t[i]&&u.setDataValidation(o,t[i].validator,{row:d,col:f,rowCount:1,colCount:1})}}for(var i=0;i<r.length;i++){var s=r[i],l=s.sheetName,d=s.cells,f=s.fromSheet,m=s.mergedRegions;n(d,l,f);var h=e.getSheetFromName(l);if(m&&m.length>0){var p,g=Object(o["a"])(m.values());try{for(g.s();!(p=g.n()).done;){var v=p.value,w=v.row,C=v.rowCount,b=v.col,S=v.colCount;h.addSpan(w,b,C,S,3)}}catch(y){g.e(y)}finally{g.f()}}}},editCell:function(e,t){var r=t[0].data,n=r[0],o=n.sheetName,a=n.cells,i=a[0],s=i.row,l=i.col,u=i.text,d=e.getSheetFromName(o);e.commandManager().execute({cmd:"editCell",sheetName:o,row:s,col:l,newValue:u,editor:c}),"formula"in a[0]&&(u=a[0].formula,d.getCell(s,l).formula(u))},deleteImage:function(e,t){var r=t[0].data,n=r[0],o=n.sheetName,a=n.imageList,i=e.getSheetFromName(o);i.resumePaint(),i.pictures.remove(a[0].pictureName),i.repaint()},resizeImage:function(e,t){var r=t[0].data,n=r[0],o=n.sheetName,a=n.imageAttributesList,i=e.getSheetFromName(o);i.resumePaint();for(var s=0;s<a.length;s++){var l=a[s],c=l.pictureName,u=l.startRow,d=l.startColumn,f=l.startColumnOffset,m=l.startRowOffset,h=l.endRow,p=l.endColumn,g=l.endColumnOffset,v=l.endRowOffset,w=i.pictures.get(c);w&&(w.startRow(u),w.startColumn(d),w.startColumnOffset(f),w.startRowOffset(m),w.endRow(h),w.endColumn(p),w.endColumnOffset(g),w.endRowOffset(v))}i.repaint()},clearHyperlink:function(e,t){var r=t[0].data,n=r[0],o=n.sheetName,a=n.cells,i=e.commandManager();console.log(a);var s=a[0],l=s.col,u=s.row,d=s.HyperlinkTxt,f=s.linkType,m=s.content,h=s.tooltip,p=s.value;i.execute({cmd:"clearHyperlink",sheetName:o,row:u,col:l,editor:c,content:m,tooltip:h,linkType:f,HyperlinkTxt:d,value:p})},deleteRows:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);Object(i["l"])(a,o,"deleteRows")},deleteColumns:function(e,t){var r=t[0],n=r.sheetName,o=r.selections,a=e.getSheetFromName(n);Object(i["k"])(a,o,"deleteColumns")},addRows:function(e,t){var r=t[0],n=r.data,o=r.selections,a=n[0].sheetName,s=e.getSheetFromName(a);Object(i["l"])(s,o,"addRows",(function(){u.setCells(e,t)}))},addColumns:function(e,t){var r=t[0],n=r.data,o=r.selections,a=n[0].sheetName,s=e.getSheetFromName(a);Object(i["k"])(s,o,"addColumns",(function(){u.setCells(e,t)}))},setDataValidation:function(e,t,r){var n=GC.Spread.Sheets.DataValidation,o=null,a=t.type,i=t.comparisonOperator,s=t.condition;3==a&&(s.formula&&(o=n.createFormulaListValidator(s.formula)),s.expected&&(o=n.createListValidator(s.expected))),1==a&&(i||0==i||(i=6),o=7==i||6==i?n.createNumberValidator(i,s.item1.expected,s.item2.expected,!0):n.createNumberValidator(i,s.expected,null,!0)),6==a&&(i||0==i||(i=6),o=7==i||6==i?n.createTextLengthValidator(i,s.item1.expected,s.item2.expected):n.createTextLengthValidator(i,s.expected)),e.setDataValidator(r.row,r.col,r.rowCount,r.colCount,o,3)},unmergeCells:function(e,t){var r=t[0].data,n=r[0],a=n.sheetName,i=n.unmergedRegions,s=n.mergedRegions,l=e.getSheetFromName(a);i=i instanceof Array?i:[i];for(var c=0;c<i.length;c++){var u=i[c],d=u.row,f=u.col,m=u.rowCount,h=u.colCount;d=-1===d?0:d,f=-1===f?0:f;for(var p=0;p<m;p++)for(var g=0;g<h;g++)l.removeSpan(d+p,f+g)}var v,w=Object(o["a"])(s.values());try{for(w.s();!(v=w.n()).done;){var C=v.value,b=C.row,S=C.rowCount,y=C.col,x=C.colCount;l.addSpan(b,y,S,x,3)}}catch(N){w.e(N)}finally{w.f()}},setForeColor:function(e,t){console.log(t);for(var r=t[0].data,n=r[0],o=n.sheetName,i=n.cells,s=e.getSheetFromName(o),l=0;l<i.length;l++){var u=i[l],d=u.row,f=u.col,m=s.getCell(d,f),h=Object.keys(i[l]),p=new Set(Object(a["a"])(h).filter((function(e){return!new Set(["text","formula"]).has(e)})));h=Array.from(p);for(var g=2;g<h.length;g++){var v=h[g],w=i[l][v];v in m&&"function"==typeof m[v]&&m[v](w)}if("text"in i[l]){var C=i[l].text;e.commandManager().execute({cmd:"editCell",sheetName:o,row:d,col:f,newValue:C,editor:c}),"formula"in i[l]&&(C=i[l].formula,m.formula(C))}}},deleteCellImage:function(e,t){s["a"].deleteCellImage(e,t[0].data)},insertCellImage:function(e,t){s["a"].insertCellImage(e,t[0].data)},transformToCellImage:function(e,t){s["a"].transformToCellImage(e,t[0].data)},transformToImage:function(e,t){s["a"].transformToImage(e,t[0].data)},batchTransformToCellImage:function(e,t){s["a"].batchTransformToCellImage(e,t[0].data)},batchTransformToImage:function(e,t){s["a"].batchTransformToImage(e,t[0].data)},insertPicture:function(e,t){var r=t[0].data,n=r[0],o=n.sheetName,a=n.imageAttributesList,s=e.getSheetFromName(o);a.forEach((function(e){Object(i["j"])(s,e)}))},clearCellType:function(e,t){s["a"].clearCellType(e,t[0].data)},addCheckbox:function(e,t){l["h"](e,Object(n["a"])(Object(n["a"])({},t[0].data[0]),{},{flag:!0}))}}},f183:function(e,t,r){var n=r("d012"),o=r("861d"),a=r("5135"),i=r("9bf2").f,s=r("90e3"),l=r("bb2f"),c=s("meta"),u=0,d=Object.isExtensible||function(){return!0},f=function(e){i(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},m=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,c)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[c].objectID},h=function(e,t){if(!a(e,c)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[c].weakData},p=function(e){return l&&g.REQUIRED&&d(e)&&!a(e,c)&&f(e),e},g=e.exports={REQUIRED:!1,fastKey:m,getWeakData:h,onFreeze:p};n[c]=!0}}]);