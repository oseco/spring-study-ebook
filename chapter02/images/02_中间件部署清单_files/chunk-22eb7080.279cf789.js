(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22eb7080"],{"04d1":function(e,t,n){var r=n("342f"),o=r.match(/firefox\/(\d+)/i);e.exports=!!o&&+o[1]},"0b25":function(e,t,n){var r=n("a691"),o=n("50c4");e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=o(t);if(t!==n)throw RangeError("Wrong length or index");return n}},"0d21":function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return r}))},"0f32":function(e,t,n){var r=n("b047"),o=n("1a8c"),i="Expected a function";function a(e,t,n){var a=!0,s=!0;if("function"!=typeof e)throw new TypeError(i);return o(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:a,maxWait:t,trailing:s})}e.exports=a},1448:function(e,t,n){var r=n("ebb5").aTypedArrayConstructor,o=n("4840");e.exports=function(e,t){var n=o(e,e.constructor),i=0,a=t.length,s=new(r(n))(a);while(a>i)s[i]=t[i++];return s}},"145ea":function(e,t,n){"use strict";var r=n("7b0b"),o=n("23cb"),i=n("50c4"),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),s=i(n.length),c=o(e,s),u=o(t,s),l=arguments.length>2?arguments[2]:void 0,h=a((void 0===l?s:o(l,s))-u,s-c),d=1;u<c&&c<u+h&&(d=-1,u+=h-1,c+=h-1);while(h-- >0)u in n?n[c]=n[u]:delete n[c],c+=d,u+=d;return n}},"170b":function(e,t,n){"use strict";var r=n("ebb5"),o=n("50c4"),i=n("23cb"),a=n("4840"),s=r.aTypedArray,c=r.exportTypedArrayMethod;c("subarray",(function(e,t){var n=s(this),r=n.length,c=i(e,r);return new(a(n,n.constructor))(n.buffer,n.byteOffset+c*n.BYTES_PER_ELEMENT,o((void 0===t?r:i(t,r))-c))}))},"182d":function(e,t,n){var r=n("f8cd");e.exports=function(e,t){var n=r(e);if(n%t)throw RangeError("Wrong offset");return n}},"219c":function(e,t,n){"use strict";var r=n("ebb5"),o=n("da84"),i=n("d039"),a=n("1c0b"),s=n("50c4"),c=n("addb"),u=n("04d1"),l=n("d998"),h=n("2d00"),d=n("512c"),f=r.aTypedArray,p=r.exportTypedArrayMethod,y=o.Uint16Array,g=y&&y.prototype.sort,v=!!g&&!i((function(){var e=new y(2);e.sort(null),e.sort({})})),b=!!g&&!i((function(){if(h)return h<74;if(u)return u<67;if(l)return!0;if(d)return d<602;var e,t,n=new y(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(n.sort((function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0})),m=function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!==n?-1:t!==t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}};p("sort",(function(e){var t=this;if(void 0!==e&&a(e),b)return g.call(t,e);f(t);var n,r=s(t.length),o=Array(r);for(n=0;n<r;n++)o[n]=t[n];for(o=c(t,m(e)),n=0;n<r;n++)t[n]=o[n];return t}),!b||v)},"222c":function(e,t,n){"use strict";var r=n("1da1"),o=(n("96cf"),n("159b"),n("99af"),n("ac1f"),n("1276"),n("4de4"),n("caad"),n("2532"),n("5319"),function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)});function i(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function s(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=i.next()).done)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u=function(){function e(e,t){this.target=t,this.type=e}return e}(),l=function(e){function t(t,n){var r=e.call(this,"error",n)||this;return r.message=t.message,r.error=t,r}return i(t,e),t}(u),h=function(e){function t(t,n,r){void 0===t&&(t=1e3),void 0===n&&(n="");var o=e.call(this,"close",r)||this;return o.wasClean=!0,o.code=t,o.reason=n,o}return i(t,e),t}(u),d=function(){if("undefined"!==typeof WebSocket)return WebSocket},f=function(e){return"undefined"!==typeof e&&!!e&&2===e.CLOSING},p={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},y=function(){function e(e,t,n){var r=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){r._debug("open event");var t=r._options.minUptime,n=void 0===t?p.minUptime:t;clearTimeout(r._connectTimeout),r._uptimeTimeout=setTimeout((function(){return r._acceptOpen()}),n),r._ws.binaryType=r._binaryType,r._messageQueue.forEach((function(e){return r._ws.send(e)})),r._messageQueue=[],r.onopen&&r.onopen(e),r._listeners.open.forEach((function(t){return r._callEventListener(e,t)}))},this._handleMessage=function(e){r._debug("message event"),r.onmessage&&r.onmessage(e),r._listeners.message.forEach((function(t){return r._callEventListener(e,t)}))},this._handleError=function(e){r._debug("error event",e.message),r._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),r.onerror&&r.onerror(e),r._debug("exec error listeners"),r._listeners.error.forEach((function(t){return r._callEventListener(e,t)})),r._connect()},this._handleClose=function(e){r._debug("close event"),r._clearTimeouts(),r._shouldReconnect&&r._connect(),r.onclose&&r.onclose(e),r._listeners.close.forEach((function(t){return r._callEventListener(e,t)}))},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce((function(e,t){return"string"===typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e}),0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?p.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,r=this._listeners[e.type];if(r)try{for(var o=a(r),i=o.next();!i.done;i=o.next()){var s=i.value;this._callEventListener(e,s)}}catch(c){t={error:c}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((function(e){return e!==t})))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,c(["RWS>"],e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?p.reconnectionDelayGrowFactor:t,r=e.minReconnectionDelay,o=void 0===r?p.minReconnectionDelay:r,i=e.maxReconnectionDelay,a=void 0===i?p.maxReconnectionDelay:i,s=0;return this._retryCount>0&&(s=o*Math.pow(n,this._retryCount-1),s>a&&(s=a)),this._debug("next delay",s),s},e.prototype._wait=function(){var e=this;return new Promise((function(t){setTimeout(t,e._getNextDelay())}))},e.prototype._getNextUrl=function(e){if("string"===typeof e)return Promise.resolve(e);if("function"===typeof e){var t=e();if("string"===typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,r=void 0===n?p.maxRetries:n,o=t.connectionTimeout,i=void 0===o?p.connectionTimeout:o,a=t.WebSocket,s=void 0===a?d():a;if(this._retryCount>=r)this._debug("max retries reached",this._retryCount,">=",r);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!f(s))throw Error("No valid WebSocket class provided");this._wait().then((function(){return e._getNextUrl(e._url)})).then((function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new s(t,e._protocols):new s(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout((function(){return e._handleTimeout()}),i))}))}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new l(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new h(e,t,this))}catch(n){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}(),g=y,v=n("2c3c"),b=n("6cfa"),m=n("f121"),w=n("b775"),T=n("2f0b"),_=n("ca00"),S=n("4dee"),x=n("b893"),E=n("3835"),A=(n("b0c0"),n("b64b"),n("a434"),["#F72E00","#FFE500","#93D051","#03AFF1","#574BFF","#BF0200","#FFC000","#06AF51","#006FC0","#460391"]),I=function(){var e=Math.floor(10*Math.random());return A[e]},C=function(e){var t,n=e.id,r=e.sheetName,o=e.row,i=e.col,a=this.authorIdMapCell[r][o][i];a.splice(a.indexOf(n),1),(null===(t=this.authorFloatLayer)||void 0===t?void 0:t.id)==n&&(this.authorFloatLayer=null)},O=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I(),r=e.sheetName,o=e.row,i=e.col,a=this.spread.getSheetFromName(r);if(a){var s={};s[t.id]={id:t.id,name:t.name,sheetName:r,row:o,col:i,authorColor:n},this.authorIdMap=Object.assign({},this.authorIdMap,s);var c=this.authorIdMapCell;c[r]||(c[r]={});var u=c[r];u[o]||(u[o]={});var l=u[o];l[i]||(l[i]=[]);var h=l[i];h.push(t.id)}},R={EDIT_STATUSES:function(e){var t=this,n=[];e.forEach((function(e){var r=e.user;(t.isEdit||r.id!=t.userId)&&n.push({userId:r.id,userName:r.name})})),this.users=n,this.isEdit&&this.users.length>m["f"].max&&(v["a"].warning({content:"亲，当前编辑人数已达上限，将为您自动切换为阅读模式！"}),this.onChangeStatus());var r=this.authorIdMap;this.authorIdMap={},this.authorIdMapCell={},this.isEdit&&e.forEach((function(e){var n,o=e.cell,i=e.user;o&&O.call(t,o,i,null===(n=r[o.id])||void 0===n?void 0:n.authorColor)}))},SELECT:function(e){if(this.isEdit){var t,n=e.cell,r=e.user,o=this.authorIdMap[r.id];o&&(C.call(this,o),t=o.authorColor),O.call(this,n,r,t)}},USER_ENTER:function(e){var t=e.user;this.users.some((function(e){return e.userId==t.id}))||this.users.push({userId:t.id,userName:t.name})},USER_LEAVE:function(e){var t=e.user;if(this.users=this.users.filter((function(e){return e.userId!=t.id})),this.isEdit){var n=this.authorIdMapCell[t.id];n&&C.call(this,n)}}},L=n("0f32"),M=n.n(L),N=n("b047"),F=n.n(N),k={name:"authorHightLight",data:function(){return{users:[],authorFloatLayer:null,highLightRect:[],authorIdMap:{}}},computed:{authorFloatStyle:function(){var e=this.authorFloatLayer;return e?{background:e.authorColor,left:e.x-2+"px",top:e.y+(this.isFullScreen?40:80+this.offsetY)+"px"}:{}},authorName:function(){var e=this.authorFloatLayer;return e?"".concat(e.name,"(").concat(e.id,")"):""}},watch:{authorIdMap:function(){this.queryHighLightRect()}},created:function(){this.authorIdMapCell={}},methods:{queryHighLightRect:F()((function(){var e=this;if(!this.isEdit)return this.highLightRect=[];var t=this.spread.getActiveSheet();if(t){var n=t.name(),r=[];Object.keys(this.authorIdMap).forEach((function(o){var i=e.authorIdMap[o];if(i.sheetName===n){t.getCell(i.row,i.col);var a=t.getCellRect(i.row,i.col),s=a.height,c=a.width,u=a.x,l=a.y;c&&r.push({height:s+1,width:c+1,top:(l||0)-1,left:(u||0)-1,color:i.authorColor})}})),this.highLightRect=r}}),50),getHighLightStyle:function(e){return{width:e.width+"px",height:e.height+"px",left:e.left+"px",top:e.top+"px",border:"2px solid ".concat(e.color)}},sendAuthorWS:function(e){var t=this;this.authorStatusTimer&&clearTimeout(this.authorStatusTimer),this.isEdit&&(this.authorStatusTimer=setTimeout((function(){t.authorWS.send(e)}),1e3))},createAuthorSocket:function(){var e=this,t="".concat(m["f"].ws,"/revision/docs/"),n="".concat(t).concat(this.id,"/edit-status/").concat(this.userId,"/").concat(this.isEdit?"edit":"preview");this.authorWS=new g(n),this.authorWS.onopen=function(t){e.resetAuthorHeartTimer()},this.authorWS.onerror=function(e){console.log("authorWS onerror()",e)},this.authorWS.onmessage=function(t){if(e.resetAuthorHeartTimer(),"PONG"!=t.data){var n=t.data.split("|"),r=Object(E["a"])(n,2),o=r[0],i=r[1];if(!i&&!R[o])return console.log("错误！无法识别的长链接消息类型：",o);var a=JSON.parse(i);e.authorWSArr||(e.authorWSArr=[]),e.authorWSArr.push({type:"author",authorWSType:o,data:a.data}),e.renderAuthorStatus()}}},resetAuthorHeartTimer:function(){var e=this;this.authorHeartTimer&&clearInterval(this.authorHeartTimer),this.authorHeartTimer=setInterval((function(){e.authorWS&&e.authorWS.send("PING")}),3e4)},renderAuthorStatus:M()((function(e){var t=this;this.authorWSArr.forEach((function(e){R[e.authorWSType].call(t,e.data)})),this.authorWSArr=[]}),1e3),scrollBar:M()((function(){this.queryHighLightRect()}),50,{trailing:!1})}};t["a"]={mixins:[k],data:function(){return{loadingFlag:!1,loadingTxt:"正在为您初始化文档...",updataflag:!1}},mounted:function(){var e=localStorage.getItem("fontDPIRate");e||this.getFontRate(),this.StatusContentMD=new T["a"]("StatusContent",{tipText:"StatusContent"})},created:function(){this.spread=null,this.designer=GC.Spread.Sheets.Designer,this.worker=this.$worker.create(S["a"])},beforeDestroy:function(){this.worker=null},methods:{plainExcel:function(e,t){var n=this;this.updataflag=!0,e.forEach((function(r,o){if(r.content){var i=JSON.parse(r.content);i.forEach((function(e){x["d"].call(n,e)}))}o!=e.length-1||t||setTimeout((function(){n.sendAck("ACK|".concat(r.revision),3)}),50)})),this.updataflag=!1},sendAck:function(e,t){var n=this;this.pushWS&&this.pushWS.send(e),this.ackTimer&&clearTimeout(this.ackTimer),t--,t&&(this.ackTimer=setTimeout((function(){n.sendAck(e,t)}),3e3))},paint:function(e){this.spread.suspendPaint(),this.spread.suspendEvent(),this.spread.suspendCalcService(!1),e&&this.plainExcel(e),this.spread.resumeCalcService(!1),this.spread.resumeEvent(),this.spread.resumePaint()},initPushWebSocket:function(e){var t=this,n="".concat(m["f"].ws,"/revision/docs/");this.pushWS=new g((function(){return"".concat(n).concat(t.$route.params.id,"/push/").concat(t.baseRevision,"/").concat(t.userId)})),this.pushWS.onopen=function(e){t.loadingTxt="文件正在加载实时数据......",t.resetPushHeartTimer()},this.pushWS.onerror=function(e){console.log("pushWS onerror()",e)},this.pushWS.onmessage=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var r,o,i,a,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.resetPushHeartTimer(),r=n.data.split("|"),o=JSON.parse(r[1]||n.data),t.ackTimer&&clearTimeout(t.ackTimer),!o||!o.revisions){e.next=17;break}if(i=o.revisions,a=i.filter((function(e){return"revert"==e.opType})),!a.length){e.next=15;break}return e.next=10,Object(w["a"])("/api/auth/uxUser/getUserByUserCode",{userCode:a[0].createUser});case 10:return s=e.sent,c=s.fullNameAndNo,v["a"].success(c+"还原了文档版本"),setTimeout((function(){window.location.reload()}),1800),e.abrupt("return");case 15:t.baseRevision=i[i.length-1].revision,t.paint(i);case 17:o.clientId&&(t.clientId=o.clientId);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},resetPushHeartTimer:function(){var e=this;this.pushHeartTimer&&clearInterval(this.pushHeartTimer),this.pushHeartTimer=setInterval((function(){e.pushWS&&e.pushWS.send("ping")}),3e4)},handleError:function(e){var t=this;"04"==e.resultCode&&e.message.includes("您没有访问该目录的权限，请先申请该项目的权限")?b["a"].warning({title:"错误信息",content:e.message,dangerouslySetInnerHTML:!0,okText:"申请权限",okCancel:!0,cancelText:"取消"}).then((function(){t.convertUrl("#/personCenter/myTeam?id=2&groupId=".concat(e.data))}),(function(){t.convertUrl("#/sourceFile/block/0/0")})):"用户项目文件已移除，该目录不存在！"==e.message||"您无权预览他人的私人文件！"==e.message?b["a"].warning({title:"提示信息",content:e.message,dangerouslySetInnerHTML:!0}).then((function(){"用户项目文件已移除，该目录不存在！"==e.message?t.convertUrl("#/sourceFile/block/0/0"):"您无权预览他人的私人文件！"==e.message&&t.convertUrl("#/homePage")})):e.message.includes("项目文件不存在，请刷新页面后，重新操作")&&b["a"].warning({title:"提示信息",content:"项目文件不存在!",dangerouslySetInnerHTML:!0}).then((function(){t.convertUrl("#/homePage")}))},convertUrl:function(e){var t=location,n=t.origin,r=t.pathname;r.includes("cooperative")&&(r=r.replace(/cooperative/g,""),r=r.substr(1)),location.href=n+r+e},getFontRate:function(){var e=Object(_["f"])()||[96],t=72/e[0];localStorage.setItem("fontDPIRate",t)}}}},"25a1":function(e,t,n){"use strict";var r=n("ebb5"),o=n("d58f").right,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("reduceRight",(function(e){return o(i(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2954:function(e,t,n){"use strict";var r=n("ebb5"),o=n("4840"),i=n("d039"),a=r.aTypedArray,s=r.aTypedArrayConstructor,c=r.exportTypedArrayMethod,u=[].slice,l=i((function(){new Int8Array(1).slice()}));c("slice",(function(e,t){var n=u.call(a(this),e,t),r=o(this,this.constructor),i=0,c=n.length,l=new(s(r))(c);while(c>i)l[i]=n[i++];return l}),l)},3280:function(e,t,n){"use strict";var r=n("ebb5"),o=n("e58c"),i=r.aTypedArray,a=r.exportTypedArrayMethod;a("lastIndexOf",(function(e){return o.apply(i(this),arguments)}))},3835:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("0d21");n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function o(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(c){s=!0,o=c}finally{try{a||null==n["return"]||n["return"]()}finally{if(s)throw o}}return i}}var i=n("06c5"),a=n("3d8c");function s(e,t){return Object(r["a"])(e)||o(e,t)||Object(i["a"])(e,t)||Object(a["a"])()}},"3a7b":function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").findIndex,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("findIndex",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},"3c5d":function(e,t,n){"use strict";var r=n("ebb5"),o=n("50c4"),i=n("182d"),a=n("7b0b"),s=n("d039"),c=r.aTypedArray,u=r.exportTypedArrayMethod,l=s((function(){new Int8Array(1).set({})}));u("set",(function(e){c(this);var t=i(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=a(e),s=o(r.length),u=0;if(s+t>n)throw RangeError("Wrong length");while(u<s)this[t+u]=r[u++]}),l)},"3d8c":function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return r}))},"3fcc":function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").map,i=n("4840"),a=r.aTypedArray,s=r.aTypedArrayConstructor,c=r.exportTypedArrayMethod;c("map",(function(e){return o(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(s(i(e,e.constructor)))(t)}))}))},"4a21":function(e,t,n){"use strict";var r=n("0d21"),o=n("db90"),i=n("06c5"),a=n("3d8c");function s(e){return Object(r["a"])(e)||Object(o["a"])(e)||Object(i["a"])(e)||Object(a["a"])()}var c=n("5530"),u=(n("99af"),n("b0c0"),n("fb6a"),n("159b"),n("b64b"),n("6cfa")),l=n("2c3c"),h=n("a27e"),d=(n("e456"),n("ca00")),f=n("b047"),p=n.n(f),y={id:"1.23452384164.123412415",str:""},g=null,v=null,b=function(){var e=y.str,t=y.id;null!==document.getElementById(t)&&document.getElementById(t).remove();var n=document.createElement("canvas");n.width=240,n.height=120;var r=n.getContext("2d");r.rotate(-20*Math.PI/180),r.font="15px Vedana",r.fillStyle="rgba(0, 0, 0, 0.08)",r.textAlign="left",r.textBaseline="Middle",r.fillText(e,n.width/20,n.height);var o=document.createElement("div");return o.id=t,o.style.pointerEvents="none",o.style.top="0px",o.style.left="0px",g?(o.style.position="absolute",o.style.zIndex="100000",o.style.width="100%",o.style.height="100%",o.style.background="url("+n.toDataURL("image/png")+") left top repeat",g.style.position||(g.style.position="relative"),g.appendChild(o)):(o.style.position="fixed",o.style.zIndex="100000",o.style.width=document.documentElement.clientWidth+"px",o.style.height=document.documentElement.clientHeight+"px",o.style.background="url("+n.toDataURL("image/png")+") left top repeat",document.body.appendChild(o)),t},m=function(){b()};y.set=function(e,t){y.str=e,g=t,b(),v=setInterval((function(){null===document.getElementById(y.id)&&b()}),2e3),window.addEventListener("resize",p()(m,200),!1)},y.destroy=function(){var e=y.id;v&&clearInterval(v),v=null,window.removeEventListener("resize",m),null!==document.getElementById(e)&&document.getElementById(e).remove(),g=null};var w=y,T=n("53ca"),_=(n("bf19"),n("b1cd")),S=n("b893"),x=function(e,t){var n=t.pictures.all();n.forEach((function(n){var r=n.name();-1!=r.indexOf("CellImage")&&(Object(_["f"])(e,{sheetName:t.name(),pictureName:r,row:n.startRow(),col:n.startColumn(),src:n.src()},!1),t.pictures.remove(r))}))},E=function(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++)for(var o=r[n],i=e[o],a=0,s=Object.keys(i);a<s.length;a++){var c=s[a];t(parseInt(o),parseInt(c))}},A=function(e){for(var t=function(){var t=e.getSheet(n);x(e,t);var r=t.toJSON(),o=(r["name"],r["data"].dataTable);if(!o)return{v:void 0};E(o,(function(e,n){t.getCell(e,n);var r=t.getFormatter(e,n);if('[=1]"☑";[=0]"☐";0;@'==r&&(t.setFormatter(e,n,null),t.clear(e,n,1,1,GC.Spread.Sheets.SheetArea.viewport,GC.Spread.Sheets.StorageType.hyperlink),!(t.getCellType(e,n)instanceof GC.Spread.Sheets.CellTypes.CheckBox))){var o=new GC.Spread.Sheets.CellTypes.CheckBox;t.setCellType(e,n,o),Object(S["r"])(t,e,n,{hAlign:GC.Spread.Sheets.HorizontalAlign.center,vAlign:GC.Spread.Sheets.VerticalAlign.center})}}))},n=0;n<e.getSheetCount();n++){var r=t();if("object"===Object(T["a"])(r))return r.v}},I=JSON.parse(sessionStorage.getItem("loginUserInfo"))||{},C=I.currentUser;t["a"]={data:function(){return{id:this.$route.params.id,userId:C&&C.userName?C.userName:null,userName:C&&C.fullName?C.fullName:null,isFullScreen:!1,groupDoc:!1,excelId:"upss",clientId:null,baseRevision:0,excelName:"",excelInfo:null,canEdit:!1,expired:!1,allowEdit:!0,allowCopy:!0,count:0,domHeight:null,isEdit:!0}},watch:{isEdit:function(e,t){var n=this;this.$nextTick((function(){n.updateLayout()}))}},mounted:function(){window.addEventListener("resize",this.onResize)},beforeDestroy:function(){this.authorWS&&this.authorWS.close(),this.normalPushTimer&&clearInterval(this.normalPushTimer),this.spread&&this.spread.destroy(),window.removeEventListener("resize",this.onResize)},created:function(){this.isProtectedMap={},this.userId||this.getUserInfo(),this.getFileDetailByIdSubTable()},methods:{getFileDetailByIdSubTable:function(){var e=this;this.$httpService.getFileDetailByIdSubTable({id:this.id,queryParentCatalog:!1,queryDocumentLabel:!1,queryOperationLog:!1,queryDocUserCollectId:!0,queryEditValidTime:!0,createFileLog:!0}).then((function(t){e.excelInfo=t,e.groupDoc=100==t.catalogType,e.excelName=t.fileShowName.substr(0,t.fileShowName.lastIndexOf(".")),document.title=e.excelName,e.allowEdit=!t.lockStatus,e.allowCopy=!t.copyStatus,e.canEdit=(t.roleType||t.createUser==e.userId||e.allowEdit)&&t.flag;var n=t.editValidTimeBO||{validFlag:!1};e.expired=e.verExpired(n),e.editValidTime=Object(c["a"])(Object(c["a"])({},n),{},{lockStatus:t.lockStatus}),e.isEdit=e.canEdit&&!e.expired&&e.allowEdit&&!e.isRead,e.init()})).catch((function(t){e.handleError(t)}))},changeCopyStatus:function(e){this.allowCopy=!e},verExpired:function(e){if(e){var t=e.validFlag,n=e.validTimeType;if(t&&"period"==n){var r=e.endTime,o=e.startTime,i=moment(o).diff(moment()),a=moment(r).diff(moment());if(!(i<=0&&a>0))return!0}}return!1},init:function(){this.setWatermark(),this.spread=new GC.Spread.Sheets.Workbook(document.getElementById(this.excelId),{allowExtendPasteRange:!0,scrollbarMaxAlign:!0,calcOnDemand:!0,newTabVisible:!1,allowUserDragDrop:!1,allowSheetReorder:!0,tabEditable:!1}),this.loadingFlag=!0;var e=new GC.Spread.Sheets.StatusBar.StatusBar(document.getElementById("statusBar"));e.bind(this.spread),e.remove("cellMode"),e.add(this.StatusContentMD),this.spread.suspendCalcService(!1),this.queryFile()},queryFile:function(){var e=this;h["a"].request({url:"/api/doc/file/".concat(this.id,"/").concat(this.count)}).then((function(t){if(e.count++,0==t.data.resultCode){var n=t.data.data;n.mergeResult&&l["a"].warning(n.mergeResult),e.render(n)}else u["a"].warning({title:"错误信息",content:t.data.message||"获取项目文件详情信息时异常","ok-cancel":!1})}))},render:function(e){this.baseRevision=e.lastHistoryArchivedRevision;var t=e.downloadUrl,n=(e.mergeResult,e.ssjsonDownloadUrls),r=e.sheetNameList;e.name;if(n&&n.length){for(var o=r?r.length:1,i=0;i<o;i++){var a=r&&r[i]?r[i]:"SNsheet".concat(i),s=this.spread.getSheet(i);s?s.name(a):this.spread.addSheet(i,new GC.Spread.Sheets.Worksheet(a))}n.length>1?(this.StatusContentMD.updateProgress(1/(r.length+1)),this.queryJson(n)):this.queryFileUrl(n[0])}else this.getOssData(t)},queryJson:function(e){var t=this,n=s(e),r=(n[0],n.slice(1));this.pending={max:r.length,index:0,urls:[]},this.errJson=!1,r.forEach((function(e,n){if(n<6)return t.loadJson(e);t.pending.urls.push(e)}))},loadJson:function(e){var t=this;h["a"].request({url:e}).then((function(e){var n=e.data,r=n.index,o=n.rowCount,i=n.columnCount,a=n.name;if(e.data.rowCount=o<100?100:parseInt(o)+20,i<35&&(e.data.columnCount=35),"rowFilter"in e.data){var s=e.data.rowFilter.range,c=s.row,u=s.rowCount;if(0===u){var l=Object.keys(e.data.data.dataTable);e.data.rowFilter.range.rowCount=1*l[l.length-1]-c+1}}e.data.isProtected&&(t.isProtectedMap[a]=!0),e.data.isProtected=!0,e.data.namedStyles.forEach((function(e){!0!==e.locked&&(e.locked=null)})),e.data.protectionOptions={allowSort:!0,allowFilter:!0,allowResizeColumns:!0,allowResizeRows:!0};var h=t.spread.getSheet(r);h.fromJSON(e.data),t.pending.index++,t.StatusContentMD.updateProgress(t.pending.index/t.pending.max),t.pending.index==t.pending.max?(t.pending=null,t.load()):t.pending.urls.length&&t.loadJson(t.pending.urls.shift())}),(function(e){t.errJson||(t.errJson=!0,t.pending.urls=[],t.queryFile())}))},load:function(){var e,t=0;do{e=this.spread.getSheet(t),t++}while(!e.visible());this.isEdit&&(e.options.isProtected=!1),this.spread.setActiveSheet(e.name()),A(this.spread);var n=e.getActiveColumnIndex(),r=e.getActiveRowIndex();d["r"].call(this,e,r,n),this.designer.wrapper.spread=this.spread,this.spread.options.tabEditable=this.isEdit,this.spread.resumeCalcService(!1),GC.Spread.Sheets.Commands.dragCopyFloatingObjects.execute=function(){},this.loadingFlag=!1,this.StatusContentMD.updateText("加载完毕"),this.cmdEventsWatchs&&this.cmdEventsWatchs()},initBindEvent:function(e,t){e.tips&&(this.loadingTxt=e.tips),this.spread.fromJSON(e.spreadInfo,{doNotRecalculateAfterLoad:!0}),this.spread.commandManager().SNexecute=function(e){var t=this[e.cmd];if(t)return t.execute(this.xc,e,1)},this.load()},queryFileUrl:function(e){var t=this;this.StatusContentMD.updateProgress(.1),h["a"].request({url:e}).then((function(e){t.postWorker(e.data)})).catch((function(e){t.queryFile()}))},getOssData:function(e){var t=this;this.StatusContentMD.updateProgress(.1),h["a"].request({url:e,responseType:"blob",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){t.StatusContentMD.updateProgress(.4);var n=new File([e.data],t.excelName,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=new GC.Spread.Excel.IO;r.open(n,(function(e){t.postWorker(e)}),(function(e){t.loadingFlag=!1,l["a"].error({content:e.errorMessage,duration:3e3})}))})).catch((function(e){t.queryFile()}))},createIsProtectedMap:function(e){var t=this,n=e.sheets;Object.keys(n).forEach((function(e){var r=n[e];r.isProtected&&(t.isProtectedMap[e]=!0)}))},postWorker:function(e){var t=this;this.createIsProtectedMap(e),this.StatusContentMD.updateProgress(.85);var n=JSON.stringify(e);this.worker.postMessage("runSpreadInfo",[n]).then((function(e){t.initBindEvent(e,t.excelId)})).catch((function(e){console.error(e)}))},setWatermark:function(){var e=this.excelInfo.waterMark;1==e&&w.set("苏宁文档(".concat(this.userName).concat(this.userId,")"))},getUserInfo:function(){var e=this;h["a"].request({url:"/api/auth/user/getCurrentUserInfo",params:{onlyQueryUserInfo:!0}}).then((function(t){var n=t["data"]["data"].currentUser;e.userId=n.userName,e.userName=n.fullName}))},onResize:function(){var e=this;this._windowResizeTimer&&window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=window.setTimeout((function(){e.isFullScreen=document.body.scrollHeight===window.screen.height&&document.body.scrollWidth===window.screen.width,e.$nextTick((function(){e.updateLayout()}))}),500)},updateLayout:function(){var e=this,t=e.spread,n=document.getElementById(e.excelId)||this.spread.getHost();if(t&&n){var r=document.documentElement.clientHeight-n.offsetTop-28;this.domHeight=this.isFullScreen?r:null,this.$nextTick((function(){t.refresh()}))}}}}},"4dee":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("d3b7"),n("159b"),n("4de4"),n("ac1f"),n("5319"),n("caad"),n("2532");var r=[{message:"pushCurUserEditDt",func:function(e){var t=new Headers({"Content-Type":"application/json"}),n={baseRevision:52,clientId:"add5a254beaf497a8d9e7bf8ca3e3deb",docId:"25463",content:'[{"opType":"cloneSheet","sheetName":"Sheet1","newSheetName":"Sheet1副本(1)"}]',errorCode:"0",opType:"cloneSheet",sheetName:"Sheet1"},r={method:"POST",headers:t,mode:"cors",cache:"default",credentials:"include",responseType:"text",async:!1,body:n},o=new Request(e,r);fetch(o).then((function(e){console.log(e)})).then((function(e){console.log(e)})).catch((function(e){console.error(e)}))}},{message:"runSpreadInfo",func:function(e){var t={tips:"",spreadInfo:null},n=JSON.parse(e),r=n["sheets"];for(var o in r){var i=r[o],a=i.rowCount,s=i.columnCount,c=i.namedStyles;if(r[o].isProtected=!0,(c||[]).forEach((function(e){!0!==e.locked&&(e.locked=null)})),r[o].protectionOptions={allowSort:!0,allowFilter:!0,allowResizeColumns:!0,allowResizeRows:!0},"floatingObjects"in r[o]&&r[o].floatingObjects.length>5&&(t.tips="该表格带有多个图片，加载需要一定使时间......"),"rowFilter"in r[o]){var u=r[o].rowFilter.range,l=u.row,h=u.rowCount;if(0===h){var d=[];for(var f in r[o].data.dataTable)d.push(f);r[o].rowFilter.range.rowCount=1*d[d.length-1]-l+1}}r[o].rowCount=a<100?100:parseInt(a)+20,s<35&&(r[o].columnCount=35)}return n.allowExtendPasteRange=n.scrollbarMaxAlign=!0,n.newTabVisible=n.allowUserDragDrop=!1,n.allowSheetReorder=!0,t.spreadInfo=n,t}},{message:"StatusCalculationRes",func:function(e){var t=e.filter((function(e){return!isNaN(parseFloat(e))}));function n(e){return e.reduce((function(e,t,n,r){return 1*e+1*t}))}var r="",o="";return t.length>0&&(r=n(t),o=r/t.length),{sumResult:r,averageRes:o}}},{message:"copySheetName",func:function(e,t){t=r(t);var n="";function r(e){var t=e.replace(/’|‘/g,"'").replace(/“|”/g,'"');return t=t.replace(/【/g,"[").replace(/】/g,"]").replace(/｛/g,"{").replace(/｝/g,"}").replace(/（/g,"(").replace(/）/g,")"),t=t.replace(/，/g,",").replace(/：/g,":"),t}function o(e,t){if(e.includes(t)){var r=t.substr(0,t.lastIndexOf("(")),i=t.substr(t.lastIndexOf("(")),a=1*i.substr(1,i.length-2);r+="(".concat(a+1,")"),o(e,r)}else n=t}var i=JSON.parse(e),a=i["sheets"],s=[];for(var c in a){var u=r(c);s.push(u)}return o(s,t),n}}]},"512c":function(e,t,n){var r=n("342f"),o=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!o&&+o[1]},"5cc6":function(e,t,n){var r=n("74e8");r("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"5f96":function(e,t,n){"use strict";var r=n("ebb5"),o=r.aTypedArray,i=r.exportTypedArrayMethod,a=[].join;i("join",(function(e){return a.apply(o(this),arguments)}))},"60bd":function(e,t,n){"use strict";var r=n("da84"),o=n("ebb5"),i=n("e260"),a=n("b622"),s=a("iterator"),c=r.Uint8Array,u=i.values,l=i.keys,h=i.entries,d=o.aTypedArray,f=o.exportTypedArrayMethod,p=c&&c.prototype[s],y=!!p&&("values"==p.name||void 0==p.name),g=function(){return u.call(d(this))};f("entries",(function(){return h.call(d(this))})),f("keys",(function(){return l.call(d(this))})),f("values",g,!y),f(s,g,!y)},"621a":function(e,t,n){"use strict";var r=n("da84"),o=n("83ab"),i=n("a981"),a=n("9112"),s=n("e2cc"),c=n("d039"),u=n("19aa"),l=n("a691"),h=n("50c4"),d=n("0b25"),f=n("77a7"),p=n("e163"),y=n("d2bb"),g=n("241c").f,v=n("9bf2").f,b=n("81d5"),m=n("d44e"),w=n("69f3"),T=w.get,_=w.set,S="ArrayBuffer",x="DataView",E="prototype",A="Wrong length",I="Wrong index",C=r[S],O=C,R=r[x],L=R&&R[E],M=Object.prototype,N=r.RangeError,F=f.pack,k=f.unpack,P=function(e){return[255&e]},D=function(e){return[255&e,e>>8&255]},U=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},W=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},j=function(e){return F(e,23,4)},B=function(e){return F(e,52,8)},H=function(e,t){v(e[E],t,{get:function(){return T(this)[t]}})},q=function(e,t,n,r){var o=d(n),i=T(e);if(o+t>i.byteLength)throw N(I);var a=T(i.buffer).bytes,s=o+i.byteOffset,c=a.slice(s,s+t);return r?c:c.reverse()},G=function(e,t,n,r,o,i){var a=d(n),s=T(e);if(a+t>s.byteLength)throw N(I);for(var c=T(s.buffer).bytes,u=a+s.byteOffset,l=r(+o),h=0;h<t;h++)c[u+h]=l[i?h:t-h-1]};if(i){if(!c((function(){C(1)}))||!c((function(){new C(-1)}))||c((function(){return new C,new C(1.5),new C(NaN),C.name!=S}))){O=function(e){return u(this,O),new C(d(e))};for(var J,V=O[E]=C[E],z=g(C),Y=0;z.length>Y;)(J=z[Y++])in O||a(O,J,C[J]);V.constructor=O}y&&p(L)!==M&&y(L,M);var $=new R(new O(2)),Q=L.setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||s(L,{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},{unsafe:!0})}else O=function(e){u(this,O,S);var t=d(e);_(this,{bytes:b.call(new Array(t),0),byteLength:t}),o||(this.byteLength=t)},R=function(e,t,n){u(this,R,x),u(e,O,x);var r=T(e).byteLength,i=l(t);if(i<0||i>r)throw N("Wrong offset");if(n=void 0===n?r-i:h(n),i+n>r)throw N(A);_(this,{buffer:e,byteLength:n,byteOffset:i}),o||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},o&&(H(O,"byteLength"),H(R,"buffer"),H(R,"byteLength"),H(R,"byteOffset")),s(R[E],{getInt8:function(e){return q(this,1,e)[0]<<24>>24},getUint8:function(e){return q(this,1,e)[0]},getInt16:function(e){var t=q(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=q(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return W(q(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return W(q(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return k(q(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return k(q(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){G(this,1,e,P,t)},setUint8:function(e,t){G(this,1,e,P,t)},setInt16:function(e,t){G(this,2,e,D,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){G(this,2,e,D,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){G(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){G(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){G(this,4,e,j,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){G(this,8,e,B,t,arguments.length>2?arguments[2]:void 0)}});m(O,S),m(R,x),e.exports={ArrayBuffer:O,DataView:R}},"649e":function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").some,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("some",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},"72f7":function(e,t,n){"use strict";var r=n("ebb5").exportTypedArrayMethod,o=n("d039"),i=n("da84"),a=i.Uint8Array,s=a&&a.prototype||{},c=[].toString,u=[].join;o((function(){c.call({})}))&&(c=function(){return u.call(this)});var l=s.toString!=c;r("toString",c,l)},"735e":function(e,t,n){"use strict";var r=n("ebb5"),o=n("81d5"),i=r.aTypedArray,a=r.exportTypedArrayMethod;a("fill",(function(e){return o.apply(i(this),arguments)}))},"74e8":function(e,t,n){"use strict";var r=n("23e7"),o=n("da84"),i=n("83ab"),a=n("8aa7"),s=n("ebb5"),c=n("621a"),u=n("19aa"),l=n("5c6c"),h=n("9112"),d=n("50c4"),f=n("0b25"),p=n("182d"),y=n("c04e"),g=n("5135"),v=n("f5df"),b=n("861d"),m=n("7c73"),w=n("d2bb"),T=n("241c").f,_=n("a078"),S=n("b727").forEach,x=n("2626"),E=n("9bf2"),A=n("06cf"),I=n("69f3"),C=n("7156"),O=I.get,R=I.set,L=E.f,M=A.f,N=Math.round,F=o.RangeError,k=c.ArrayBuffer,P=c.DataView,D=s.NATIVE_ARRAY_BUFFER_VIEWS,U=s.TYPED_ARRAY_TAG,W=s.TypedArray,j=s.TypedArrayPrototype,B=s.aTypedArrayConstructor,H=s.isTypedArray,q="BYTES_PER_ELEMENT",G="Wrong length",J=function(e,t){var n=0,r=t.length,o=new(B(e))(r);while(r>n)o[n]=t[n++];return o},V=function(e,t){L(e,t,{get:function(){return O(this)[t]}})},z=function(e){var t;return e instanceof k||"ArrayBuffer"==(t=v(e))||"SharedArrayBuffer"==t},Y=function(e,t){return H(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},$=function(e,t){return Y(e,t=y(t,!0))?l(2,e[t]):M(e,t)},Q=function(e,t,n){return!(Y(e,t=y(t,!0))&&b(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?L(e,t,n):(e[t]=n.value,e)};i?(D||(A.f=$,E.f=Q,V(j,"buffer"),V(j,"byteOffset"),V(j,"byteLength"),V(j,"length")),r({target:"Object",stat:!0,forced:!D},{getOwnPropertyDescriptor:$,defineProperty:Q}),e.exports=function(e,t,n){var i=e.match(/\d+$/)[0]/8,s=e+(n?"Clamped":"")+"Array",c="get"+e,l="set"+e,y=o[s],g=y,v=g&&g.prototype,E={},A=function(e,t){var n=O(e);return n.view[c](t*i+n.byteOffset,!0)},I=function(e,t,r){var o=O(e);n&&(r=(r=N(r))<0?0:r>255?255:255&r),o.view[l](t*i+o.byteOffset,r,!0)},M=function(e,t){L(e,t,{get:function(){return A(this,t)},set:function(e){return I(this,t,e)},enumerable:!0})};D?a&&(g=t((function(e,t,n,r){return u(e,g,s),C(function(){return b(t)?z(t)?void 0!==r?new y(t,p(n,i),r):void 0!==n?new y(t,p(n,i)):new y(t):H(t)?J(g,t):_.call(g,t):new y(f(t))}(),e,g)})),w&&w(g,W),S(T(y),(function(e){e in g||h(g,e,y[e])})),g.prototype=v):(g=t((function(e,t,n,r){u(e,g,s);var o,a,c,l=0,h=0;if(b(t)){if(!z(t))return H(t)?J(g,t):_.call(g,t);o=t,h=p(n,i);var y=t.byteLength;if(void 0===r){if(y%i)throw F(G);if(a=y-h,a<0)throw F(G)}else if(a=d(r)*i,a+h>y)throw F(G);c=a/i}else c=f(t),a=c*i,o=new k(a);R(e,{buffer:o,byteOffset:h,byteLength:a,length:c,view:new P(o)});while(l<c)M(e,l++)})),w&&w(g,W),v=g.prototype=m(j)),v.constructor!==g&&h(v,"constructor",g),U&&h(v,U,s),E[s]=g,r({global:!0,forced:g!=y,sham:!D},E),q in g||h(g,q,i),q in v||h(v,q,i),x(s)}):e.exports=function(){}},"77a7":function(e,t){var n=Math.abs,r=Math.pow,o=Math.floor,i=Math.log,a=Math.LN2,s=function(e,t,s){var c,u,l,h=new Array(s),d=8*s-t-1,f=(1<<d)-1,p=f>>1,y=23===t?r(2,-24)-r(2,-77):0,g=e<0||0===e&&1/e<0?1:0,v=0;for(e=n(e),e!=e||e===1/0?(u=e!=e?1:0,c=f):(c=o(i(e)/a),e*(l=r(2,-c))<1&&(c--,l*=2),e+=c+p>=1?y/l:y*r(2,1-p),e*l>=2&&(c++,l/=2),c+p>=f?(u=0,c=f):c+p>=1?(u=(e*l-1)*r(2,t),c+=p):(u=e*r(2,p-1)*r(2,t),c=0));t>=8;h[v++]=255&u,u/=256,t-=8);for(c=c<<t|u,d+=t;d>0;h[v++]=255&c,c/=256,d-=8);return h[--v]|=128*g,h},c=function(e,t){var n,o=e.length,i=8*o-t-1,a=(1<<i)-1,s=a>>1,c=i-7,u=o-1,l=e[u--],h=127&l;for(l>>=7;c>0;h=256*h+e[u],u--,c-=8);for(n=h&(1<<-c)-1,h>>=-c,c+=t;c>0;n=256*n+e[u],u--,c-=8);if(0===h)h=1-s;else{if(h===a)return n?NaN:l?-1/0:1/0;n+=r(2,t),h-=s}return(l?-1:1)*n*r(2,h-t)};e.exports={pack:s,unpack:c}},"81d5":function(e,t,n){"use strict";var r=n("7b0b"),o=n("23cb"),i=n("50c4");e.exports=function(e){var t=r(this),n=i(t.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,u=void 0===c?n:o(c,n);while(u>s)t[s++]=e;return t}},"82f8":function(e,t,n){"use strict";var r=n("ebb5"),o=n("4d64").includes,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("includes",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},"8aa7":function(e,t,n){var r=n("da84"),o=n("d039"),i=n("1c7e"),a=n("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,c=r.Int8Array;e.exports=!a||!o((function(){c(1)}))||!o((function(){new c(-1)}))||!i((function(e){new c,new c(null),new c(1.5),new c(e)}),!0)||o((function(){return 1!==new c(new s(2),1,void 0).length}))},"9a8c":function(e,t,n){"use strict";var r=n("ebb5"),o=n("145ea"),i=r.aTypedArray,a=r.exportTypedArrayMethod;a("copyWithin",(function(e,t){return o.call(i(this),e,t,arguments.length>2?arguments[2]:void 0)}))},a078:function(e,t,n){var r=n("7b0b"),o=n("50c4"),i=n("35a1"),a=n("e95a"),s=n("0366"),c=n("ebb5").aTypedArrayConstructor;e.exports=function(e){var t,n,u,l,h,d,f=r(e),p=arguments.length,y=p>1?arguments[1]:void 0,g=void 0!==y,v=i(f);if(void 0!=v&&!a(v)){h=v.call(f),d=h.next,f=[];while(!(l=d.call(h)).done)f.push(l.value)}for(g&&p>2&&(y=s(y,arguments[2],2)),n=o(f.length),u=new(c(this))(n),t=0;n>t;t++)u[t]=g?y(f[t],t):f[t];return u}},a975:function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").every,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("every",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},a981:function(e,t){e.exports="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView},addb:function(e,t){var n=Math.floor,r=function(e,t){var a=e.length,s=n(a/2);return a<8?o(e,t):i(r(e.slice(0,s),t),r(e.slice(s),t),t)},o=function(e,t){var n,r,o=e.length,i=1;while(i<o){r=i,n=e[i];while(r&&t(e[r-1],n)>0)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},i=function(e,t,n){var r=e.length,o=t.length,i=0,a=0,s=[];while(i<r||a<o)i<r&&a<o?s.push(n(e[i],t[a])<=0?e[i++]:t[a++]):s.push(i<r?e[i++]:t[a++]);return s};e.exports=r},b39a:function(e,t,n){"use strict";var r=n("da84"),o=n("ebb5"),i=n("d039"),a=r.Int8Array,s=o.aTypedArray,c=o.exportTypedArrayMethod,u=[].toLocaleString,l=[].slice,h=!!a&&i((function(){u.call(new a(1))})),d=i((function(){return[1,2].toLocaleString()!=new a([1,2]).toLocaleString()}))||!i((function(){a.prototype.toLocaleString.call([1,2])}));c("toLocaleString",(function(){return u.apply(h?l.call(s(this)):s(this),arguments)}),d)},c1ac:function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").filter,i=n("1448"),a=r.aTypedArray,s=r.exportTypedArrayMethod;s("filter",(function(e){var t=o(a(this),e,arguments.length>1?arguments[1]:void 0);return i(this,t)}))},ca91:function(e,t,n){"use strict";var r=n("ebb5"),o=n("d58f").left,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("reduce",(function(e){return o(i(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},cd26:function(e,t,n){"use strict";var r=n("ebb5"),o=r.aTypedArray,i=r.exportTypedArrayMethod,a=Math.floor;i("reverse",(function(){var e,t=this,n=o(t).length,r=a(n/2),i=0;while(i<r)e=t[i],t[i++]=t[--n],t[n]=e;return t}))},d139:function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").find,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("find",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},d58f:function(e,t,n){var r=n("1c0b"),o=n("7b0b"),i=n("44ad"),a=n("50c4"),s=function(e){return function(t,n,s,c){r(n);var u=o(t),l=i(u),h=a(u.length),d=e?h-1:0,f=e?-1:1;if(s<2)while(1){if(d in l){c=l[d],d+=f;break}if(d+=f,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=f)d in l&&(c=n(c,l[d],d,u));return c}};e.exports={left:s(!1),right:s(!0)}},d5d6:function(e,t,n){"use strict";var r=n("ebb5"),o=n("b727").forEach,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("forEach",(function(e){o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},d998:function(e,t,n){var r=n("342f");e.exports=/MSIE|Trident/.test(r)},e58c:function(e,t,n){"use strict";var r=n("fc6a"),o=n("a691"),i=n("50c4"),a=n("a640"),s=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,l=a("lastIndexOf"),h=u||!l;e.exports=h?function(e){if(u)return c.apply(this,arguments)||0;var t=r(this),n=i(t.length),a=n-1;for(arguments.length>1&&(a=s(a,o(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:c},e91f:function(e,t,n){"use strict";var r=n("ebb5"),o=n("4d64").indexOf,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("indexOf",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},ebb5:function(e,t,n){"use strict";var r,o=n("a981"),i=n("83ab"),a=n("da84"),s=n("861d"),c=n("5135"),u=n("f5df"),l=n("9112"),h=n("6eeb"),d=n("9bf2").f,f=n("e163"),p=n("d2bb"),y=n("b622"),g=n("90e3"),v=a.Int8Array,b=v&&v.prototype,m=a.Uint8ClampedArray,w=m&&m.prototype,T=v&&f(v),_=b&&f(b),S=Object.prototype,x=S.isPrototypeOf,E=y("toStringTag"),A=g("TYPED_ARRAY_TAG"),I=o&&!!p&&"Opera"!==u(a.opera),C=!1,O={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},R={BigInt64Array:8,BigUint64Array:8},L=function(e){if(!s(e))return!1;var t=u(e);return"DataView"===t||c(O,t)||c(R,t)},M=function(e){if(!s(e))return!1;var t=u(e);return c(O,t)||c(R,t)},N=function(e){if(M(e))return e;throw TypeError("Target is not a typed array")},F=function(e){if(p){if(x.call(T,e))return e}else for(var t in O)if(c(O,r)){var n=a[t];if(n&&(e===n||x.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},k=function(e,t,n){if(i){if(n)for(var r in O){var o=a[r];if(o&&c(o.prototype,e))try{delete o.prototype[e]}catch(s){}}_[e]&&!n||h(_,e,n?t:I&&b[e]||t)}},P=function(e,t,n){var r,o;if(i){if(p){if(n)for(r in O)if(o=a[r],o&&c(o,e))try{delete o[e]}catch(s){}if(T[e]&&!n)return;try{return h(T,e,n?t:I&&T[e]||t)}catch(s){}}for(r in O)o=a[r],!o||o[e]&&!n||h(o,e,t)}};for(r in O)a[r]||(I=!1);if((!I||"function"!=typeof T||T===Function.prototype)&&(T=function(){throw TypeError("Incorrect invocation")},I))for(r in O)a[r]&&p(a[r],T);if((!I||!_||_===S)&&(_=T.prototype,I))for(r in O)a[r]&&p(a[r].prototype,_);if(I&&f(w)!==_&&p(w,_),i&&!c(_,E))for(r in C=!0,d(_,E,{get:function(){return s(this)?this[A]:void 0}}),O)a[r]&&l(a[r],A,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:I,TYPED_ARRAY_TAG:C&&A,aTypedArray:N,aTypedArrayConstructor:F,exportTypedArrayMethod:k,exportTypedArrayStaticMethod:P,isView:L,isTypedArray:M,TypedArray:T,TypedArrayPrototype:_}},edc0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("99af");function r(e){var t=moment(e).diff(moment(),"day"),n=moment.duration(moment(e)-moment(),"ms"),r=n.get("hours"),o=n.get("minutes"),i=n.get("seconds");return t>0?o>0?"".concat(t,"天").concat(r,"时").concat(o,"分"):r>0?"".concat(t,"天").concat(r,"小时"):"".concat(t,"天"):r>0?o>0?"".concat(r,"时").concat(o,"分"):"".concat(r,"小时"):o>0?i>0?"".concat(o,"分").concat(i,"秒"):"".concat(o,"分钟"):"".concat(i,"秒")}},f8cd:function(e,t,n){var r=n("a691");e.exports=function(e){var t=r(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}}}]);