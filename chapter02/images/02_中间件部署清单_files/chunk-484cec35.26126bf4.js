(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-484cec35"],{8440:function(e,t,i){"use strict";i("fd0c")},f8f1:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"zaixian"}},[i("excelHeader",{directives:[{name:"show",rawName:"v-show",value:!e.isFullScreen,expression:"!isFullScreen"}],ref:"child",attrs:{id:e.id,"excel-name":e.excelName,excelInfo:e.excelInfo,tipsFlag:e.tipsFlag,"is-edit":e.isEdit,"can-edit":e.canEdit&&!e.expired,users:e.users,"group-doc":e.groupDoc,"edit-valid-time":e.editValidTime},on:{"on-change-status":e.onChangeStatus,"on-end":e.onEnd}},[i("rightMenu",{ref:"rightMenu",attrs:{id:e.id,"is-edit":e.isEdit,"can-edit":e.canEdit,"allow-copy":e.allowCopy,"edit-valid-time":e.editValidTime,spread:e.spread,"allow-edit":e.allowEdit},on:{"on-change-copy":e.changeCopyStatus,exportExcel:e.exportExcel,getFromRange:e.getFromRange,resetFormatPainting:e.resetFormatPainting,setCellsAutoFitRow:e.setCellsAutoFitRow,doClear:e.doClear,"on-edit-valid-time":e.getEditValidTime,"on-export":e.exportExcel}})],1),i("editor",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],ref:"editor",attrs:{spread:e.spread,isFormatPainting:e.isFormatPainting,tipsFlag:e.tipsFlag},on:{"set-formular":e.setFormular,getFromRange:e.getFromRange,resetFormatPainting:e.resetFormatPainting,setCellsAutoFitRow:e.setCellsAutoFitRow,doClear:e.doClear}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticClass:"formulaBar",staticStyle:{width:"100%"}},[i("table",{staticStyle:{width:"100%"},attrs:{border:"0"}},[i("tr",[i("td",[i("div",{staticClass:"union-container formula-bar-item"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.namedRangeSelector,expression:"namedRangeSelector"}],staticClass:"named-range-selector union-item",attrs:{type:"text",readonly:"readonly",name:"namedRangeSelector"},domProps:{value:e.namedRangeSelector},on:{input:function(t){t.target.composing||(e.namedRangeSelector=t.target.value)}}})])]),e._m(0)])])]),i("div",{ref:"upss",class:e.isEdit?"":"isRead",style:[e.domHeight?{height:e.domHeight+"px"}:{}],attrs:{id:"upss"},on:{mousedown:function(t){return e.show_coords(t)},copy:e.onCopy,paste:e.onPaste}},[i("ux-icon",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticClass:"sn-addsheet",attrs:{type:"add-circle-o-t"},on:{click:e.snAddSheet}}),e._l(e.highLightRect,(function(t,a){return i("div",{key:a,staticClass:"highLightRect",style:e.getHighLightStyle(t)})}))],2),i("div",{attrs:{id:"statusBar"}}),i("div",[i("ux-modal",{attrs:{title:"设置"+e.customSpreadMenu,"wrap-class":"vertical-center-modal"},on:{ok:e.setHeightOrWidth},model:{value:e.customSpreadMenuFlag,callback:function(t){e.customSpreadMenuFlag=t},expression:"customSpreadMenuFlag"}},[i("p",{staticStyle:{height:"auto",overflow:"hidden"}},[i("ux-col",{attrs:{span:5}},[i("span",{staticStyle:{"line-height":"32px"}},[e._v("输入"+e._s(e.customSpreadMenu)+"(像素)")])]),i("ux-col",{attrs:{span:6}},[i("ux-input",{attrs:{placeholder:""},model:{value:e.customSpreadMenuV,callback:function(t){e.customSpreadMenuV=t},expression:"customSpreadMenuV"}})],1)],1),i("p",{ref:"colWidthTip",staticStyle:{color:"red","line-height":"24px",display:"none"}},[e._v(" 列宽最小支持设置到20像素,请重新输入 ")])])],1),i("div",[i("ux-modal",{attrs:{title:"设置添加选项","wrap-class":"vertical-center-modal"},on:{ok:e.insetMoreRowDilg},model:{value:e.insetMoreRowDialogVisible,callback:function(t){e.insetMoreRowDialogVisible=t},expression:"insetMoreRowDialogVisible"}},[i("p",{staticStyle:{height:"auto",overflow:"hidden"}},[i("ux-col",{attrs:{span:3}},[i("span",{staticStyle:{"line-height":"32px"}},[e._v(e._s(e.insertRowCol))])]),i("ux-col",{attrs:{span:8}},[i("ux-input",{attrs:{placeholder:"请输入数字，最大支持20"},model:{value:e.insetMoreRowVal,callback:function(t){e.insetMoreRowVal=t},expression:"insetMoreRowVal"}})],1)],1)])],1),i("div",[i("ux-modal",{attrs:{title:"选择需要显示的工作簿名称","wrap-class":"vertical-center-modal"},on:{ok:e.showSheetMethod},model:{value:e.showSheetDialogVisible,callback:function(t){e.showSheetDialogVisible=t},expression:"showSheetDialogVisible"}},[i("p",{staticClass:"radioWrap",staticStyle:{height:"auto",overflow:"hidden"}},[i("ux-radio-group",{attrs:{size:"small",type:"button",options:e.hiddenSheetList},on:{change:e.selectSheetList}})],1)])],1),i("div",{staticClass:"floatImg"}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loadingFlag,expression:"loadingFlag"}],staticClass:"toastBox"},[e._v(" 表格加载中，请稍后编辑... ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loadingFlag,expression:"loadingFlag"}],staticClass:"menuMask"}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.authorFloatLayer,expression:"authorFloatLayer"}],style:e.authorFloatStyle,attrs:{id:"authorFloatLayer"}},[e._v(e._s(e.authorName))])],1)},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("td",{staticStyle:{width:"100%","border-left":"1px solid #ccc","padding-left":"8px"}},[i("div",{staticStyle:{"padding-top":"0",width:"100%",height:"20px","overflow-y":"auto","overflow-x":"hidden"},attrs:{id:"formulaBarss",contenteditable:"true",spellcheck:"false"}})])}],o=i("1da1"),n=(i("96cf"),i("bf19"),i("159b"),i("b64b"),i("2c3c")),r=(i("6cfa"),i("ca00"),i("5936")),l=i("5ef5"),c=i("60dab"),d=i("4a21"),u=i("222c"),p=i("a632"),h=i("2f0b"),m=i("1d06"),g=i("b893"),v={name:"excel",components:{editor:c["a"],excelHeader:r["a"],rightMenu:l["a"]},mixins:[d["a"],u["a"],p["a"],m["a"]],data:function(){return{editValidTime:null,clientX:0,offsetY:0}},methods:{show_coords:function(e){var t=e.clientX;e.clientY;this.clientX=t},getEditValidTime:function(e){this.expired=this.verExpired(e),this.editValidTime=e},onEnd:function(){this.expired=!0},onChangeStatus:function(){this.isEdit=!this.isEdit,this.spread.options.tabEditable=this.isEdit,this.authorWS&&this.authorWS.close(),this.createAuthorSocket();var e=this.spread.getActiveSheet(),t=this.spread.commandManager();e.suspendPaint(),this.isEdit?(e.options.isProtected=!1,Object(h["d"])(this.spread),t.addListener("anyscLicenser",this.anyscLicenser),this.setIntervalNormalPush()):(this.normalPushTimer&&clearInterval(this.normalPushTimer),e.options.protectionOptions.allowSort=!0,e.options.protectionOptions.allowFilter=!0,e.options.protectionOptions.allowResizeColumns=!0,e.options.protectionOptions.allowResizeRows=!0,e.options.isProtected=!0,this.spread.contextMenu.menuData=[],t.removeListener("anyscLicenser",this.anyscLicenser)),e.resumePaint()},exportExcel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new GC.Spread.Excel.IO,a=e.excelName,t.next=4,Object(g["s"])(e.spread.toJSON());case 4:s=t.sent,o=s.sheets,Object.keys(o).forEach((function(t){var i=o[t];i.isProtected=!!e.isProtectedMap[t]})),i.save(s,(function(e){saveAs(e,"".concat(a,".xlsx"))}),(function(e){n["a"].error({content:"导出失败，请稍后刷新重试",duration:3e3})}));case 8:case"end":return t.stop()}}),t)})))()},onCopy:function(e){this.isEdit||this.allowCopy||e.preventDefault()},onPaste:function(e){var t=this,i=w(e);i.length&&(e.preventDefault(),this.uploadImg(i[0],(function(e,i,a){t.insertPictureMd(e,i,a)})))}}};function w(e){var t=e.clipboardData,i=null===t||void 0===t?void 0:t.items,a=[];if(1!=i.length)return a;for(var s in i)if(Object.prototype.hasOwnProperty.call(i,s)){var o=i[s],n=o.type;/image/i.test(n)&&a.push(o.getAsFile())}return a}var f=v,x=(i("8440"),i("2877")),S=Object(x["a"])(f,a,s,!1,null,null,null),y=S.exports;t["default"]=y},fd0c:function(e,t,i){}}]);